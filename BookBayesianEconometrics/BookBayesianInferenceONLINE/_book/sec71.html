<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.1 Multivariate regression | Introduction to Bayesian Econometrics</title>
  <meta name="description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="7.1 Multivariate regression | Introduction to Bayesian Econometrics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="github-repo" content="https://github.com/aramir21/IntroductionBayesianEconometricsBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.1 Multivariate regression | Introduction to Bayesian Econometrics" />
  
  <meta name="twitter:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  

<meta name="author" content="Andrés Ramírez-Hassan" />


<meta name="date" content="2025-07-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chap7.html"/>
<link rel="next" href="sec72.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Bayesian Econometrics: A GUIded tour using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="to-instructors-and-students.html"><a href="to-instructors-and-students.html"><i class="fa fa-check"></i>To instructors and students</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Chap1.html"><a href="Chap1.html"><i class="fa fa-check"></i><b>1</b> Basic formal concepts</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sec11.html"><a href="sec11.html"><i class="fa fa-check"></i><b>1.1</b> The Bayes’ rule</a></li>
<li class="chapter" data-level="1.2" data-path="sec12.html"><a href="sec12.html"><i class="fa fa-check"></i><b>1.2</b> Bayesian framework: A brief summary of theory</a></li>
<li class="chapter" data-level="1.3" data-path="sec14.html"><a href="sec14.html"><i class="fa fa-check"></i><b>1.3</b> Bayesian reports: Decision theory under uncertainty</a></li>
<li class="chapter" data-level="1.4" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chap2.html"><a href="Chap2.html"><i class="fa fa-check"></i><b>2</b> Conceptual differences between the Bayesian and Frequentist approaches</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec21.html"><a href="sec21.html"><i class="fa fa-check"></i><b>2.1</b> The concept of probability</a></li>
<li class="chapter" data-level="2.2" data-path="sec22.html"><a href="sec22.html"><i class="fa fa-check"></i><b>2.2</b> Subjectivity is not the key</a></li>
<li class="chapter" data-level="2.3" data-path="sec23.html"><a href="sec23.html"><i class="fa fa-check"></i><b>2.3</b> Estimation, hypothesis testing and prediction</a></li>
<li class="chapter" data-level="2.4" data-path="sec24.html"><a href="sec24.html"><i class="fa fa-check"></i><b>2.4</b> The likelihood principle</a></li>
<li class="chapter" data-level="2.5" data-path="sec25.html"><a href="sec25.html"><i class="fa fa-check"></i><b>2.5</b> Why is not the Bayesian approach that popular?</a></li>
<li class="chapter" data-level="2.6" data-path="sec26.html"><a href="sec26.html"><i class="fa fa-check"></i><b>2.6</b> A simple working example</a></li>
<li class="chapter" data-level="2.7" data-path="sec27.html"><a href="sec27.html"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
<li class="chapter" data-level="2.8" data-path="sec28.html"><a href="sec28.html"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chap3.html"><a href="Chap3.html"><i class="fa fa-check"></i><b>3</b> Cornerstone models: Conjugate families</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec41.html"><a href="sec41.html"><i class="fa fa-check"></i><b>3.1</b> Motivation of conjugate families</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sec41.html"><a href="sec41.html#examples-of-exponential-family-distributions"><i class="fa fa-check"></i><b>3.1.1</b> Examples of exponential family distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sec42.html"><a href="sec42.html"><i class="fa fa-check"></i><b>3.2</b> Conjugate prior to exponential family</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sec42.html"><a href="sec42.html#sec421"><i class="fa fa-check"></i><b>3.2.1</b> Examples: Theorem 4.2.1</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sec43.html"><a href="sec43.html"><i class="fa fa-check"></i><b>3.3</b> Linear regression: The conjugate normal-normal/inverse gamma model</a></li>
<li class="chapter" data-level="3.4" data-path="sec44.html"><a href="sec44.html"><i class="fa fa-check"></i><b>3.4</b> Multivariate linear regression: The conjugate normal-normal/inverse Wishart model</a></li>
<li class="chapter" data-level="3.5" data-path="sec45.html"><a href="sec45.html"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
<li class="chapter" data-level="3.6" data-path="sec46.html"><a href="sec46.html"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chap4.html"><a href="Chap4.html"><i class="fa fa-check"></i><b>4</b> Simulation methods</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec51.html"><a href="sec51.html"><i class="fa fa-check"></i><b>4.1</b> Markov Chain Monte Carlo methods</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sec51.html"><a href="sec51.html#sec511"><i class="fa fa-check"></i><b>4.1.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="4.1.2" data-path="sec51.html"><a href="sec51.html#sec512"><i class="fa fa-check"></i><b>4.1.2</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="4.1.3" data-path="sec51.html"><a href="sec51.html#sec513"><i class="fa fa-check"></i><b>4.1.3</b> Hamiltonian Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec52.html"><a href="sec52.html"><i class="fa fa-check"></i><b>4.2</b> Importance sampling</a></li>
<li class="chapter" data-level="4.3" data-path="sec53.html"><a href="sec53.html"><i class="fa fa-check"></i><b>4.3</b> Particle filtering</a></li>
<li class="chapter" data-level="4.4" data-path="sec54.html"><a href="sec54.html"><i class="fa fa-check"></i><b>4.4</b> Convergence diagnostics</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sec54.html"><a href="sec54.html#numerical-standard-error"><i class="fa fa-check"></i><b>4.4.1</b> Numerical standard error</a></li>
<li class="chapter" data-level="4.4.2" data-path="sec54.html"><a href="sec54.html#effective-number-of-simulation-draws"><i class="fa fa-check"></i><b>4.4.2</b> Effective number of simulation draws</a></li>
<li class="chapter" data-level="4.4.3" data-path="sec54.html"><a href="sec54.html#tests-of-convergence"><i class="fa fa-check"></i><b>4.4.3</b> Tests of convergence</a></li>
<li class="chapter" data-level="4.4.4" data-path="sec54.html"><a href="sec54.html#checking-for-errors-in-the-posterior-simulator"><i class="fa fa-check"></i><b>4.4.4</b> Checking for errors in the posterior simulator</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sec55.html"><a href="sec55.html"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
<li class="chapter" data-level="4.6" data-path="sec56.html"><a href="sec56.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chap5.html"><a href="Chap5.html"><i class="fa fa-check"></i><b>5</b> Graphical user interface</a>
<ul>
<li class="chapter" data-level="5.1" data-path="secGUI1.html"><a href="secGUI1.html"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="secGUI2.html"><a href="secGUI2.html"><i class="fa fa-check"></i><b>5.2</b> Univariate models</a></li>
<li class="chapter" data-level="5.3" data-path="secGUI3.html"><a href="secGUI3.html"><i class="fa fa-check"></i><b>5.3</b> Multivariate models</a></li>
<li class="chapter" data-level="5.4" data-path="secGUI4.html"><a href="secGUI4.html"><i class="fa fa-check"></i><b>5.4</b> Time series models</a></li>
<li class="chapter" data-level="5.5" data-path="secGUI5.html"><a href="secGUI5.html"><i class="fa fa-check"></i><b>5.5</b> Longitudinal/panel models</a></li>
<li class="chapter" data-level="5.6" data-path="secGUI6.html"><a href="secGUI6.html"><i class="fa fa-check"></i><b>5.6</b> Bayesian model average</a></li>
<li class="chapter" data-level="5.7" data-path="secGUI7.html"><a href="secGUI7.html"><i class="fa fa-check"></i><b>5.7</b> Help</a></li>
<li class="chapter" data-level="5.8" data-path="secGUI8.html"><a href="secGUI8.html"><i class="fa fa-check"></i><b>5.8</b> Warning</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Chap6.html"><a href="Chap6.html"><i class="fa fa-check"></i><b>6</b> Univariate regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec61.html"><a href="sec61.html"><i class="fa fa-check"></i><b>6.1</b> The Gaussian linear model</a></li>
<li class="chapter" data-level="6.2" data-path="sec62.html"><a href="sec62.html"><i class="fa fa-check"></i><b>6.2</b> The logit model</a></li>
<li class="chapter" data-level="6.3" data-path="sec63.html"><a href="sec63.html"><i class="fa fa-check"></i><b>6.3</b> The probit model</a></li>
<li class="chapter" data-level="6.4" data-path="sec64.html"><a href="sec64.html"><i class="fa fa-check"></i><b>6.4</b> The multinomial probit model</a></li>
<li class="chapter" data-level="6.5" data-path="sec65.html"><a href="sec65.html"><i class="fa fa-check"></i><b>6.5</b> The multinomial logit model</a></li>
<li class="chapter" data-level="6.6" data-path="sec66.html"><a href="sec66.html"><i class="fa fa-check"></i><b>6.6</b> Ordered probit model</a></li>
<li class="chapter" data-level="6.7" data-path="negative-binomial-model.html"><a href="negative-binomial-model.html"><i class="fa fa-check"></i><b>6.7</b> Negative binomial model</a></li>
<li class="chapter" data-level="6.8" data-path="sec68.html"><a href="sec68.html"><i class="fa fa-check"></i><b>6.8</b> Tobit model</a></li>
<li class="chapter" data-level="6.9" data-path="sec69.html"><a href="sec69.html"><i class="fa fa-check"></i><b>6.9</b> Quantile regression</a></li>
<li class="chapter" data-level="6.10" data-path="sec610.html"><a href="sec610.html"><i class="fa fa-check"></i><b>6.10</b> Bayesian bootstrap regression</a></li>
<li class="chapter" data-level="6.11" data-path="sec611.html"><a href="sec611.html"><i class="fa fa-check"></i><b>6.11</b> Summary</a></li>
<li class="chapter" data-level="6.12" data-path="sec612.html"><a href="sec612.html"><i class="fa fa-check"></i><b>6.12</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Chap7.html"><a href="Chap7.html"><i class="fa fa-check"></i><b>7</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec71.html"><a href="sec71.html"><i class="fa fa-check"></i><b>7.1</b> Multivariate regression</a></li>
<li class="chapter" data-level="7.2" data-path="sec72.html"><a href="sec72.html"><i class="fa fa-check"></i><b>7.2</b> Seemingly Unrelated Regression</a></li>
<li class="chapter" data-level="7.3" data-path="sec73.html"><a href="sec73.html"><i class="fa fa-check"></i><b>7.3</b> Instrumental variable</a></li>
<li class="chapter" data-level="7.4" data-path="sec74.html"><a href="sec74.html"><i class="fa fa-check"></i><b>7.4</b> Multivariate probit model</a></li>
<li class="chapter" data-level="7.5" data-path="sec75.html"><a href="sec75.html"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
<li class="chapter" data-level="7.6" data-path="sec76.html"><a href="sec76.html"><i class="fa fa-check"></i><b>7.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Chap8.html"><a href="Chap8.html"><i class="fa fa-check"></i><b>8</b> Time series</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec81.html"><a href="sec81.html"><i class="fa fa-check"></i><b>8.1</b> State-space representation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sec81.html"><a href="sec81.html#gaussian-linear-state-space-models"><i class="fa fa-check"></i><b>8.1.1</b> Gaussian linear state-space models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sec82.html"><a href="sec82.html"><i class="fa fa-check"></i><b>8.2</b> ARMA processes</a></li>
<li class="chapter" data-level="8.3" data-path="sec83.html"><a href="sec83.html"><i class="fa fa-check"></i><b>8.3</b> Stochastic volatility models</a></li>
<li class="chapter" data-level="8.4" data-path="sec84.html"><a href="sec84.html"><i class="fa fa-check"></i><b>8.4</b> Vector Autoregressive models</a></li>
<li class="chapter" data-level="8.5" data-path="sec85.html"><a href="sec85.html"><i class="fa fa-check"></i><b>8.5</b> Summary</a></li>
<li class="chapter" data-level="8.6" data-path="sec86.html"><a href="sec86.html"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Chap9.html"><a href="Chap9.html"><i class="fa fa-check"></i><b>9</b> Longitudinal regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec91.html"><a href="sec91.html"><i class="fa fa-check"></i><b>9.1</b> Normal model</a></li>
<li class="chapter" data-level="9.2" data-path="sec92.html"><a href="sec92.html"><i class="fa fa-check"></i><b>9.2</b> Logit model</a></li>
<li class="chapter" data-level="9.3" data-path="sec93.html"><a href="sec93.html"><i class="fa fa-check"></i><b>9.3</b> Poisson model</a></li>
<li class="chapter" data-level="9.4" data-path="sec94.html"><a href="sec94.html"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="sec95.html"><a href="sec95.html"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Chap10.html"><a href="Chap10.html"><i class="fa fa-check"></i><b>10</b> Bayesian model averaging in variable selection</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec10_1.html"><a href="sec10_1.html"><i class="fa fa-check"></i><b>10.1</b> Foundation</a></li>
<li class="chapter" data-level="10.2" data-path="sec102.html"><a href="sec102.html"><i class="fa fa-check"></i><b>10.2</b> The Gaussian linear model</a></li>
<li class="chapter" data-level="10.3" data-path="sec103.html"><a href="sec103.html"><i class="fa fa-check"></i><b>10.3</b> Generalized linear models</a></li>
<li class="chapter" data-level="10.4" data-path="sec10_4.html"><a href="sec10_4.html"><i class="fa fa-check"></i><b>10.4</b> Calculating the marginal likelihood</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sec10_4.html"><a href="sec10_4.html#sec10_4_1"><i class="fa fa-check"></i><b>10.4.1</b> Savage-Dickey density ratio</a></li>
<li class="chapter" data-level="10.4.2" data-path="sec10_4.html"><a href="sec10_4.html#sec10_4_2"><i class="fa fa-check"></i><b>10.4.2</b> Chib’s methods</a></li>
<li class="chapter" data-level="10.4.3" data-path="sec10_4.html"><a href="sec10_4.html#sec10_4_3"><i class="fa fa-check"></i><b>10.4.3</b> Gelfand-Dey method</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sec10_5.html"><a href="sec10_5.html"><i class="fa fa-check"></i><b>10.5</b> Summary</a></li>
<li class="chapter" data-level="10.6" data-path="sec10_6.html"><a href="sec10_6.html"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Chap11.html"><a href="Chap11.html"><i class="fa fa-check"></i><b>11</b> Semi-parametric and non-parametric models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec11_1.html"><a href="sec11_1.html"><i class="fa fa-check"></i><b>11.1</b> Mixture models</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sec11_1.html"><a href="sec11_1.html#sec11_11"><i class="fa fa-check"></i><b>11.1.1</b> Finite Gaussian mixtures</a></li>
<li class="chapter" data-level="11.1.2" data-path="sec11_1.html"><a href="sec11_1.html#sec11_12"><i class="fa fa-check"></i><b>11.1.2</b> Direchlet processes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sec11_2.html"><a href="sec11_2.html"><i class="fa fa-check"></i><b>11.2</b> Splines</a></li>
<li class="chapter" data-level="11.3" data-path="sec11_3.html"><a href="sec11_3.html"><i class="fa fa-check"></i><b>11.3</b> Summary</a></li>
<li class="chapter" data-level="11.4" data-path="sec11_4.html"><a href="sec11_4.html"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Chap12.html"><a href="Chap12.html"><i class="fa fa-check"></i><b>12</b> Bayesian machine learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sec12_1.html"><a href="sec12_1.html"><i class="fa fa-check"></i><b>12.1</b> Cross-validation and Bayes factors</a></li>
<li class="chapter" data-level="12.2" data-path="sec12_2.html"><a href="sec12_2.html"><i class="fa fa-check"></i><b>12.2</b> Regularization</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sec12_2.html"><a href="sec12_2.html#sec12_21"><i class="fa fa-check"></i><b>12.2.1</b> Bayesian LASSO</a></li>
<li class="chapter" data-level="12.2.2" data-path="sec12_2.html"><a href="sec12_2.html#sec12_22"><i class="fa fa-check"></i><b>12.2.2</b> Stochastic search variable selection</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sec12_3.html"><a href="sec12_3.html"><i class="fa fa-check"></i><b>12.3</b> Bayesian additive regression trees</a></li>
<li class="chapter" data-level="12.4" data-path="sec12_4.html"><a href="sec12_4.html"><i class="fa fa-check"></i><b>12.4</b> Gaussian processes</a></li>
<li class="chapter" data-level="12.5" data-path="sec12_5.html"><a href="sec12_5.html"><i class="fa fa-check"></i><b>12.5</b> Tall data problems</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="sec12_5.html"><a href="sec12_5.html#sec12_51"><i class="fa fa-check"></i><b>12.5.1</b> Divide-and-conquer methods</a></li>
<li class="chapter" data-level="12.5.2" data-path="sec12_5.html"><a href="sec12_5.html#sec12_52"><i class="fa fa-check"></i><b>12.5.2</b> Subsampling-based algorithms</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="id_13_6.html"><a href="id_13_6.html"><i class="fa fa-check"></i><b>12.6</b> Summary</a></li>
<li class="chapter" data-level="12.7" data-path="id_13_7.html"><a href="id_13_7.html"><i class="fa fa-check"></i><b>12.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Chap13.html"><a href="Chap13.html"><i class="fa fa-check"></i><b>13</b> Causal inference</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec13_1.html"><a href="sec13_1.html"><i class="fa fa-check"></i><b>13.1</b> Instrumental variables</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="sec13_1.html"><a href="sec13_1.html#sec13_11"><i class="fa fa-check"></i><b>13.1.1</b> Semi-parametric IV model</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="sec13_2.html"><a href="sec13_2.html"><i class="fa fa-check"></i><b>13.2</b> Regression discontinuity design</a></li>
<li class="chapter" data-level="13.3" data-path="sec13_3.html"><a href="sec13_3.html"><i class="fa fa-check"></i><b>13.3</b> Regression kink design</a></li>
<li class="chapter" data-level="13.4" data-path="sec13_4.html"><a href="sec13_4.html"><i class="fa fa-check"></i><b>13.4</b> Synthetic control</a></li>
<li class="chapter" data-level="13.5" data-path="sec13_5.html"><a href="sec13_5.html"><i class="fa fa-check"></i><b>13.5</b> Difference in difference estimation</a></li>
<li class="chapter" data-level="13.6" data-path="sec13_6.html"><a href="sec13_6.html"><i class="fa fa-check"></i><b>13.6</b> Event Analysis</a></li>
<li class="chapter" data-level="13.7" data-path="sec13_7.html"><a href="sec13_7.html"><i class="fa fa-check"></i><b>13.7</b> Bayesian exponential tilted empirical likelihood</a></li>
<li class="chapter" data-level="13.8" data-path="sec13_8.html"><a href="sec13_8.html"><i class="fa fa-check"></i><b>13.8</b> Double-Debiased machine learning causal effects</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Chap14.html"><a href="Chap14.html"><i class="fa fa-check"></i><b>14</b> Approximate Bayesian methods</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec14_1.html"><a href="sec14_1.html"><i class="fa fa-check"></i><b>14.1</b> Simulation-based approaches</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="sec14_1.html"><a href="sec14_1.html#sec14_11"><i class="fa fa-check"></i><b>14.1.1</b> Approximate Bayesian computation</a></li>
<li class="chapter" data-level="14.1.2" data-path="sec14_1.html"><a href="sec14_1.html#sec14_12"><i class="fa fa-check"></i><b>14.1.2</b> Bayesian synthetic likelihood</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="sec14_2.html"><a href="sec14_2.html"><i class="fa fa-check"></i><b>14.2</b> Optimization approaches</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="sec14_2.html"><a href="sec14_2.html#sec14_21"><i class="fa fa-check"></i><b>14.2.1</b> Integrated nested Laplace approximations</a></li>
<li class="chapter" data-level="14.2.2" data-path="sec14_2.html"><a href="sec14_2.html#sec14_22"><i class="fa fa-check"></i><b>14.2.2</b> Variational Bayes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>14.3</b> Summary</a></li>
<li class="chapter" data-level="14.4" data-path="sec14_4.html"><a href="sec14_4.html"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Bayesian Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec71" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Multivariate regression<a href="sec71.html#sec71" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A complete presentation of this model is given in Section <a href="sec44.html#sec44">3.4</a>. We show here the setting, and the posterior distributions for facility in exposition. In particular, there are <span class="math inline">\(M\)</span> multiply dependent variables which share the same set of regressors, and their stochastic errors are contemporaneously correlated. In particular, <span class="math inline">\(\boldsymbol{Y} = \left[ \boldsymbol{y_{1}} \ \boldsymbol{y_{2}} \ \ldots \ \boldsymbol{y_{M}} \right]\)</span> is an <span class="math inline">\(N \times M\)</span> matrix that is generated by <span class="math inline">\(\boldsymbol{Y} = \boldsymbol{X} \boldsymbol{B} + \boldsymbol{U}\)</span> where <span class="math inline">\(\boldsymbol{X}\)</span> is an <span class="math inline">\(N \times K\)</span> matrix of regressors, <span class="math inline">\(\boldsymbol{B} = \left[ \boldsymbol{\beta}_{1} \ \boldsymbol{\beta}_{2} \ldots \boldsymbol{\beta}_{M} \right]\)</span> is a <span class="math inline">\(K \times M\)</span> matrix of parameters, and <span class="math inline">\(\boldsymbol{U} = \left[ \boldsymbol{\mu}_{1} \ \boldsymbol{\mu}_{2} \ldots \boldsymbol{\mu}_{M} \right]\)</span> is a matrix of stochastic random errors such that <span class="math inline">\(\boldsymbol{\mu}_i \sim N(\boldsymbol{0}, \boldsymbol{\Sigma})\)</span>, for <span class="math inline">\(i = 1, 2, \dots, N\)</span>, each row of <span class="math inline">\(\boldsymbol{U}\)</span>.</p>
<p>The prior is given by <span class="math inline">\(\boldsymbol{B} \mid \boldsymbol{\Sigma} \sim N(\boldsymbol{B}_0, \boldsymbol{V}_0, \boldsymbol{\Sigma})\)</span> and <span class="math inline">\(\boldsymbol{\Sigma} \sim IW(\boldsymbol{\Psi}_0, \alpha_0)\)</span>. Therefore, the conditional posterior distributions are:</p>
<p><span class="math display">\[
\boldsymbol{B} \mid \boldsymbol{\Sigma}, \boldsymbol{Y}, \boldsymbol{X} \sim N(\boldsymbol{B}_n, \boldsymbol{V}_n, \boldsymbol{\Sigma}),
\]</span></p>
<p><span class="math display">\[
\boldsymbol{\Sigma} \mid \boldsymbol{Y}, \boldsymbol{X} \sim IW(\boldsymbol{\Psi}_n, \alpha_n),
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\boldsymbol{V}_n = (\boldsymbol{X}^{\top} \boldsymbol{X} + \boldsymbol{V}_0^{-1})^{-1}, \quad
\boldsymbol{B}_n = \boldsymbol{V}_n (\boldsymbol{V}_0^{-1} \boldsymbol{B}_0 + \boldsymbol{X}^{\top} \boldsymbol{X} \hat{\boldsymbol{B}}),
\]</span></p>
<p><span class="math display">\[
\hat{\boldsymbol{B}} = (\boldsymbol{X}^{\top} \boldsymbol{X})^{-1} \boldsymbol{X}^{\top} \boldsymbol{Y}, \quad
\boldsymbol{S} = (\boldsymbol{Y} - \boldsymbol{X}\hat{\boldsymbol{B}})^{\top}(\boldsymbol{Y} - \boldsymbol{X}\hat{\boldsymbol{B}}),\]</span>
<span class="math display">\[
\boldsymbol{\Psi}_n = \boldsymbol{\Psi}_{0} + \boldsymbol{S} + \boldsymbol{B}_{0}^{\top} \boldsymbol{V}_{0}^{-1} \boldsymbol{B}_{0} + \hat{\boldsymbol{B}}^{\top} \boldsymbol{X}^{\top} \boldsymbol{X} \hat{\boldsymbol{B}} - \boldsymbol{B}_n^{\top} \boldsymbol{V}_n^{-1} \boldsymbol{B}_n,
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\alpha_n = \alpha_0 + N.
\]</span></p>
<p>We can use a Gibbs sampling algorithm in this model since the conditional posterior distributions are standard.</p>
<p><strong>Example: The effect of institutions on per capita gross domestic product</strong></p>
<p>To illustrate multivariate regression models, we use the dataset provided by <span class="citation">Acemoglu, Johnson, and Robinson (<a href="#ref-Acemoglu2001">2001</a>)</span>, who analyzed the effect of property rights on economic growth.</p>
<p>We begin with the following <em>simultaneous structural</em> economic model:<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
<span class="math display" id="eq:str1">\[\begin{align}
    \log(\text{pcGDP95}_i) &amp;= \beta_1 + \beta_2 \text{PAER}_i + \beta_3 \text{Africa} + \beta_4 \text{Asia} + \beta_5 \text{Other} + u_{1i},
    \tag{7.1}
\end{align}\]</span>
<span class="math display" id="eq:str2">\[\begin{align}
    \text{PAER}_i &amp;= \alpha_1 + \alpha_2 \log(\text{pcGDP95}_i) + \alpha_3 \log(\text{Mort}_i) + u_{2i},
    \tag{7.2}
\end{align}\]</span>
where <em>pcGDP95</em>, <em>PAER</em>, and <em>Mort</em> represent the per capita gross domestic product (GDP) in 1995, the average index of protection against expropriation between 1985 and 1995, and the settler mortality rate during the period of colonization, respectively. <em>Africa</em>, <em>Asia</em>, and <em>Other</em> are indicator variables for continents, with <em>America</em> serving as the baseline group.</p>
<p>In this model, there is <em>reverse (simultaneous) causality</em> due to the contemporaneous effect of <em>GDP</em> on <em>PAER</em>, and vice versa.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Therefore, estimating Equations <a href="sec71.html#eq:str1">(7.1)</a> and <a href="sec71.html#eq:str2">(7.2)</a> without accounting for this phenomenon results in posterior mean estimates that are <em>biased</em> and <em>inconsistent</em> from a sampling (frequentist) perspective.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> A potential strategy to address this issue is to estimate the <em>reduced-form</em> model, i.e., a model without <em>simultaneous causality</em>, where all <em>endogenous variables</em> are functions of <em>exogenous variables</em>. The former are determined within the model (e.g., <span class="math inline">\(\log(\text{pcGDP95}_i)\)</span> and <em>PAER</em> in this example), while the latter are determined outside the model (e.g., <span class="math inline">\(\log(\text{Mort}_i)\)</span>, <em>Africa</em>, <em>Asia</em>, and <em>Other</em> in this example).</p>
<p>Replacing Equation <a href="sec71.html#eq:str2">(7.2)</a> into Equation <a href="sec71.html#eq:str1">(7.1)</a>, and solving for <span class="math inline">\(\log(\textit{pcGDP95})\)</span>,
<span class="math display" id="eq:red1">\[\begin{align}
    \log(\text{pcGDP95}_i)=\pi_1+\pi_2\log(\text{Mort}_i)+\pi_3 \text{Africa}+\pi_4 \text{Asia}+\pi_5 \text{Other}+e_{1i}.
    \tag{7.3}
\end{align}\]</span>
Then, by substituting Equation <a href="sec71.html#eq:red1">(7.3)</a> into Equation <a href="sec71.html#eq:str2">(7.2)</a>, and solving for <em>PAER</em>, we obtain
<span class="math display" id="eq:red2">\[\begin{align}
    \text{PAER}_i = \gamma_1 + \gamma_2 \log(\text{Mort}_i) + \gamma_3 \text{Africa} + \gamma_4 \text{Asia} + \gamma_5 \text{Other} + e_{2i},
    \tag{7.4}
\end{align}\]</span>
where <span class="math inline">\(\pi_2 = \frac{\beta_2\alpha_3}{1 - \beta_2\alpha_2}\)</span> and <span class="math inline">\(\gamma_2 = \frac{\alpha_3}{1 - \beta_2\alpha_2}\)</span>, given that <span class="math inline">\(\beta_2 \alpha_2 \neq 1\)</span>, i.e., independent equations (see Exercise 2).</p>
<p>Observe that Equations <a href="sec71.html#eq:red1">(7.3)</a> and <a href="sec71.html#eq:red2">(7.4)</a> have the form of a multivariate regression model, where the common set of regressors is
<span class="math display">\[
\boldsymbol{X} = \left[\log(\text{Mort}) \ \text{Africa} \ \text{Asia} \ \text{Other}\right]
\]</span>
and the common set of dependent variables is
<span class="math display">\[
\boldsymbol{Y} = \left[\log(\text{pcGDP95}) \ \text{PAER}\right].
\]</span>
Therefore, we can estimate this model using the setup outlined in this section.</p>
<p>In the first stage, we estimate the parameters of the <em>reduced-form</em> model (Equations <a href="sec71.html#eq:red1">(7.3)</a> and <a href="sec71.html#eq:red2">(7.4)</a>), but the main interest lies in estimating the parameters of the <em>structural</em> model (Equations <a href="sec71.html#eq:str1">(7.1)</a> and <a href="sec71.html#eq:str2">(7.2)</a>). A valid question is whether we can recover (identify) the <em>structural</em> parameters from the <em>reduced-form</em> parameters. There are two criteria to answer this question: the order condition, which is necessary, and the rank condition, which is both necessary and sufficient.</p>
<p><strong>The order condition</strong></p>
<p>Given a system of equations with <span class="math inline">\(M\)</span> endogenous variables, and <span class="math inline">\(K\)</span> exogenous variables (including the intercept), there are two ways to assess the order condition:</p>
<ul>
<li>The parameters of an equation in the system are identified if there are at least <span class="math inline">\(M-1\)</span> variables excluded from the equation (<em>exclusion restrictions</em>). The equation is <em>exactly identified</em> if the number of excluded variables is <span class="math inline">\(M-1\)</span>, and is <em>over identified</em> if the number of excluded variables is greater than <span class="math inline">\(M-1\)</span>.</li>
<li>The parameters of equation <span class="math inline">\(m\)</span> in the system are identified if <span class="math inline">\(K-K_m\geq M_m-1\)</span>, where <span class="math inline">\(K_m\)</span> and <span class="math inline">\(M_m\)</span> are the number of exogenous and endogenous variables in equation <span class="math inline">\(m\)</span>, respectively. The <span class="math inline">\(m\)</span>-th equation is <em>exactly identified</em> if <span class="math inline">\(K-K_m = M_m-1\)</span>, and <em>over identified</em> if <span class="math inline">\(K-K_m &gt; M_m-1\)</span>.</li>
</ul>
<p>We can see from Equations <a href="sec71.html#eq:str1">(7.1)</a> and <a href="sec71.html#eq:str2">(7.2)</a> in this example that <span class="math inline">\(K=5\)</span>, <span class="math inline">\(M=2\)</span>, <span class="math inline">\(K_1=4\)</span>, <span class="math inline">\(K_2=2\)</span>, <span class="math inline">\(M_1=2\)</span>, and <span class="math inline">\(M_2=2\)</span>. This means that <span class="math inline">\(K-K_1=1=M-1\)</span> and <span class="math inline">\(K-K_2=3&gt;M-1=1\)</span>, that is, the order condition says that both equations satisfy the necessary condition of identification, the first equation would be <em>exactly identified</em>, and the second equation would be <em>over identified</em>. Observe that there is one excluded variable from the first equation, and there are three excluded variables from the second equation.</p>
<p><strong>The rank condition</strong></p>
<p>The rank condition (necessary and sufficient) says that given a <em>structural</em> model with <span class="math inline">\(M\)</span> equations (<span class="math inline">\(M\)</span> endogenous variables), an equation is identified if and only if there is at least one determinant different from zero from a <span class="math inline">\((M-1)\times(M-1)\)</span> matrix built using the excluded variables in the analyzed equation, but included in any other equation of the system.</p>
<p>It is useful to build the <em>identification matrix</em> to implement the <em>rank</em> condition. The next Table shows this matrix in this example.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-1">Table 7.1: </span>Example: Rank condition
</caption>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\log(\text{pcGDP95})\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{PAER}\)</span>
</td>
<td style="text-align:left;">
Constant
</td>
<td style="text-align:left;">
<span class="math inline">\(\log(\text{Mort})\)</span>
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:left;">
Other
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span class="math inline">\(-\beta_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\beta_1\)</span>
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
<span class="math inline">\(-\beta_3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\beta_4\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\beta_5\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(-\alpha_2\)</span>
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span class="math inline">\(-\alpha_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\alpha_3\)</span>
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
</tbody>
</table>
<p>The only excluded variable in the <span class="math inline">\(\log(\text{pcGDP95})\)</span> equation is <span class="math inline">\(\log(\text{Mort})\)</span>. Therefore, there is only one matrix that can be constructed using the excluded variables from this equation, which is <span class="math inline">\([-\alpha_3]\)</span> (see column 4 in the Table). The determinant of this matrix is <span class="math inline">\(-\alpha_3\)</span>, and as long as this coefficient is nonzero (i.e., <span class="math inline">\(\alpha_3 \neq 0\)</span>), meaning that the mortality rate is relevant in the PAER equation, the coefficients in the <span class="math inline">\(\log(\text{pcGDP95})\)</span> equation are <em>exactly identified</em>. For example, <span class="math inline">\(\beta_2 = \frac{\pi_2}{\gamma_2}\)</span>, which represents the effect of property rights on GDP, is exactly identified.</p>
<p>It is crucial to observe the importance of excluding <span class="math inline">\(\log(\text{Mort})\)</span> from the <span class="math inline">\(\log(\text{pcGDP95})\)</span> equation, while including <span class="math inline">\(\log(\text{Mort})\)</span> in the PAER equation. This is known as the <em>exclusion restriction</em>, which requires the presence of an exogenous source of variability in the PAER equation to help identify the <span class="math inline">\(\log(\text{pcGDP95})\)</span> equation. The presence of relevant exogenous sources of variability is an essential factor in the identification, estimation, and inference of <em>structural</em> parameters.</p>
<p>As for the identification of the <em>structural</em> parameters in the PAER equation, there are three potential matrices that can be constructed: <span class="math inline">\([-\beta_3]\)</span>, <span class="math inline">\([-\beta_4]\)</span>, and <span class="math inline">\([-\beta_5]\)</span> (see columns 5, 6, and 7 in the Table). As long as any of these parameters are relevant in the <span class="math inline">\(\log(\text{pcGDP95})\)</span> equation, the PAER equation is identified. In this case, the PAER equation is <em>over-identified</em>, meaning there are multiple ways to estimate the parameters in this equation. For example, <span class="math inline">\(\alpha_2 = \gamma_3/\pi_3 = \gamma_4/\pi_4 = \gamma_5/\pi_5\)</span> (see Exercise 2).</p>
<p>In general, recovering the <em>structural</em> parameters from the <em>reduced-form</em> parameters can be challenging due to the need for relevant identification restrictions, which can be difficult to find in some applications.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>For this example, we set non-informative priors: <span class="math inline">\(\boldsymbol{B}_0 = \left[\boldsymbol{0}_5 \ \boldsymbol{0}_5\right]\)</span>, <span class="math inline">\(\boldsymbol{V}_0 = 100 \boldsymbol{I}_K\)</span>, <span class="math inline">\(\boldsymbol{\Psi}_0 = 5 \boldsymbol{I}_2\)</span>, and <span class="math inline">\(\alpha_0 = 5\)</span>.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> Once our GUI is displayed (see the beginning of this chapter), we should follow the next Algorithm to run multivariate linear models in the GUI (see Chapter <a href="Chap5.html#Chap5">5</a> for details, particularly on how to set the data set).</p>
<div class="algorithm">
<div style="background-color: #f8f9fa; padding: 15px; border-left: 5px solid #343a40; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.1); border-radius: 5px;">
<p><strong>Algorithm: Multivariate Linear Model</strong></p>
<ol style="list-style-type: decimal">
<li><p>Select <em>Multivariate Models</em> on the top panel</p></li>
<li><p>Select <em>Simple Multivariate</em> model using the left radio button</p></li>
<li><p>Upload the dataset selecting first if there is header in the file, and the kind of separator in the <em>csv</em> file of the dataset (comma, semicolon, or tab). Then, use the <em>Browse</em> button under the <strong>Choose File</strong> legend</p></li>
<li><p>Select MCMC iterations, burn-in, and thinning parameters using the <em>Range sliders</em></p></li>
<li><p>Select the number of dependent variables in the box <strong>Number of endogenous variables: m</strong></p></li>
<li><p>Select the number of independent variables (including the intercept) in the box <strong>Number of exogenous variables: k</strong></p></li>
<li><p>Set the hyperparameters: mean vectors, covariance matrix, degrees of freedom, and the scale matrix. This step is not necessary as by default our GUI uses non-informative priors</p></li>
<li><p>Click the <em>Go!</em> button</p></li>
<li><p>Analyze results</p></li>
<li><p>Download posterior chains and diagnostic plots using the <em>Download Posterior Chains</em> and <em>Download Posterior Graphs</em> buttons</p></li>
</ol>
</div>
</div>
<p>The following <strong>R</strong> code shows how to perform the Gibss sampling algorithm in this example using the dataset <em>4Institutions.csv</em>. We ask to run this example using the <em>rmultireg</em> command from the <em>bayesm</em> package as an exercise. We find that the posterior mean <em>structural</em> effect of property rights on GDP is 0.98, and the 95% credible interval is (0.56, 2.87). This means that there is evidence supporting a positive effect of property rights on gross domestic product.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sec71.html#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="sec71.html#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1-3"><a href="sec71.html#cb1-3" tabindex="-1"></a>DataInst <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/besmarter/BSTApp/refs/heads/master/DataApp/4Institutions.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-4"><a href="sec71.html#cb1-4" tabindex="-1"></a><span class="fu">attach</span>(DataInst)</span>
<span id="cb1-5"><a href="sec71.html#cb1-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(logpcGDP95, PAER)</span>
<span id="cb1-6"><a href="sec71.html#cb1-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, logMort, Africa, Asia, Other)</span>
<span id="cb1-7"><a href="sec71.html#cb1-7" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">dim</span>(Y)[<span class="dv">2</span>]</span>
<span id="cb1-8"><a href="sec71.html#cb1-8" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb1-9"><a href="sec71.html#cb1-9" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">dim</span>(Y)[<span class="dv">1</span>]</span>
<span id="cb1-10"><a href="sec71.html#cb1-10" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb1-11"><a href="sec71.html#cb1-11" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, K, M)</span>
<span id="cb1-12"><a href="sec71.html#cb1-12" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-13"><a href="sec71.html#cb1-13" tabindex="-1"></a>V0 <span class="ot">&lt;-</span> c0<span class="sc">*</span><span class="fu">diag</span>(K)</span>
<span id="cb1-14"><a href="sec71.html#cb1-14" tabindex="-1"></a>Psi0 <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="fu">diag</span>(M)</span>
<span id="cb1-15"><a href="sec71.html#cb1-15" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-16"><a href="sec71.html#cb1-16" tabindex="-1"></a><span class="co"># Posterior parameters</span></span>
<span id="cb1-17"><a href="sec71.html#cb1-17" tabindex="-1"></a>Bhat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y </span>
<span id="cb1-18"><a href="sec71.html#cb1-18" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">t</span>(Y <span class="sc">-</span> X<span class="sc">%*%</span>Bhat)<span class="sc">%*%</span>(Y <span class="sc">-</span> X<span class="sc">%*%</span>Bhat)</span>
<span id="cb1-19"><a href="sec71.html#cb1-19" tabindex="-1"></a>Vn <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">solve</span>(V0) <span class="sc">+</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X) </span>
<span id="cb1-20"><a href="sec71.html#cb1-20" tabindex="-1"></a>Bn <span class="ot">&lt;-</span> Vn<span class="sc">%*%</span>(<span class="fu">solve</span>(V0)<span class="sc">%*%</span>B0 <span class="sc">+</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X<span class="sc">%*%</span>Bhat)</span>
<span id="cb1-21"><a href="sec71.html#cb1-21" tabindex="-1"></a>Psin <span class="ot">&lt;-</span> Psi0 <span class="sc">+</span> S <span class="sc">+</span> <span class="fu">t</span>(B0)<span class="sc">%*%</span><span class="fu">solve</span>(V0)<span class="sc">%*%</span>B0 <span class="sc">+</span> <span class="fu">t</span>(Bhat)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>X<span class="sc">%*%</span>Bhat <span class="sc">-</span> <span class="fu">t</span>(Bn)<span class="sc">%*%</span><span class="fu">solve</span>(Vn)<span class="sc">%*%</span>Bn</span>
<span id="cb1-22"><a href="sec71.html#cb1-22" tabindex="-1"></a>an <span class="ot">&lt;-</span> a0 <span class="sc">+</span> N</span>
<span id="cb1-23"><a href="sec71.html#cb1-23" tabindex="-1"></a><span class="co">#Posterior draws</span></span>
<span id="cb1-24"><a href="sec71.html#cb1-24" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#Number of posterior draws</span></span>
<span id="cb1-25"><a href="sec71.html#cb1-25" tabindex="-1"></a>SIGs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(s, LaplacesDemon<span class="sc">::</span><span class="fu">rinvwishart</span>(an, Psin))</span>
<span id="cb1-26"><a href="sec71.html#cb1-26" tabindex="-1"></a>BsCond <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>s, <span class="cf">function</span>(s) {MixMatrix<span class="sc">::</span><span class="fu">rmatrixnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean=</span>Bn, <span class="at">U =</span> Vn,<span class="at">V =</span> SIGs[,,s])})</span>
<span id="cb1-27"><a href="sec71.html#cb1-27" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(<span class="fu">t</span>(BsCond)))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##          Mean      SD  Naive SE Time-series SE
##  [1,] 10.3789 0.44935 0.0044935      0.0044935
##  [2,] -0.4170 0.09972 0.0009972      0.0009972
##  [3,] -0.7318 0.24032 0.0024032      0.0024032
##  [4,] -0.5840 0.28959 0.0028959      0.0028959
##  [5,]  0.2972 0.48248 0.0048248      0.0048248
##  [6,]  8.5156 0.75222 0.0075222      0.0075222
##  [7,] -0.4283 0.16725 0.0016725      0.0016725
##  [8,] -0.2677 0.40099 0.0040099      0.0040361
##  [9,]  0.3475 0.48749 0.0048749      0.0048749
## [10,]  1.2454 0.81787 0.0081787      0.0081787
## 
## 2. Quantiles for each variable:
## 
##          2.5%      25%     50%        75%    97.5%
## var1   9.4953 10.07783 10.3766 10.6768666 11.27717
## var2  -0.6136 -0.48366 -0.4158 -0.3496649 -0.22143
## var3  -1.1985 -0.89381 -0.7327 -0.5695042 -0.25578
## var4  -1.1527 -0.77805 -0.5827 -0.3900056 -0.01057
## var5  -0.6587 -0.02514  0.2945  0.6224207  1.24241
## var6   7.0210  8.01999  8.5116  9.0111246 10.00396
## var7  -0.7558 -0.53971 -0.4285 -0.3165409 -0.10184
## var8  -1.0600 -0.53703 -0.2676  0.0002646  0.52081
## var9  -0.6090  0.02377  0.3500  0.6740956  1.30291
## var10 -0.3446  0.69699  1.2418  1.7939884  2.86752</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sec71.html#cb3-1" tabindex="-1"></a>SIGMs <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>s, <span class="cf">function</span>(l) {gdata<span class="sc">::</span><span class="fu">lowerTriangle</span>(SIGs[,,l], <span class="at">diag=</span><span class="cn">TRUE</span>, <span class="at">byrow=</span><span class="cn">FALSE</span>)}))</span>
<span id="cb3-2"><a href="sec71.html#cb3-2" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(SIGMs))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##        Mean      SD  Naive SE Time-series SE
## [1,] 0.5381 0.09524 0.0009524      0.0009813
## [2,] 0.5372 0.13144 0.0013144      0.0013144
## [3,] 1.5225 0.26763 0.0026763      0.0026763
## 
## 2. Quantiles for each variable:
## 
##        2.5%    25%    50%    75%  97.5%
## var1 0.3853 0.4695 0.5267 0.5942 0.7545
## var2 0.3181 0.4449 0.5234 0.6137 0.8359
## var3 1.0863 1.3324 1.4924 1.6799 2.1354</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sec71.html#cb5-1" tabindex="-1"></a>hdiBs <span class="ot">&lt;-</span> HDInterval<span class="sc">::</span><span class="fu">hdi</span>(<span class="fu">t</span>(BsCond), <span class="at">credMass =</span> <span class="fl">0.95</span>) <span class="co"># Highest posterior density credible interval</span></span>
<span id="cb5-2"><a href="sec71.html#cb5-2" tabindex="-1"></a>hdiBs</span></code></pre></div>
<pre><code>##           [,1]       [,2]       [,3]        [,4]      [,5]      [,6]
## lower  9.44900 -0.6131229 -1.1769984 -1.16535714 -0.670223  7.041383
## upper 11.22169 -0.2212954 -0.2393919 -0.02786525  1.227650 10.017329
##              [,7]       [,8]       [,9]      [,10]
## lower -0.74678771 -1.0419989 -0.6358514 -0.3253181
## upper -0.09525447  0.5322414  1.2748474  2.8767518
## attr(,&quot;credMass&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sec71.html#cb7-1" tabindex="-1"></a>hdiSIG <span class="ot">&lt;-</span> HDInterval<span class="sc">::</span><span class="fu">hdi</span>(SIGMs, <span class="at">credMass =</span> <span class="fl">0.95</span>) <span class="co"># Highest posterior density credible interval</span></span>
<span id="cb7-2"><a href="sec71.html#cb7-2" tabindex="-1"></a>hdiSIG</span></code></pre></div>
<pre><code>##            [,1]      [,2]     [,3]
## lower 0.3735344 0.2960049 1.023421
## upper 0.7318534 0.8022998 2.034439
## attr(,&quot;credMass&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sec71.html#cb9-1" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> BsCond[<span class="dv">2</span>,]<span class="sc">/</span>BsCond[<span class="dv">7</span>,] </span>
<span id="cb9-2"><a href="sec71.html#cb9-2" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(beta2)) <span class="co"># Effect of property rights on GDP</span></span></code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##         0.9796        16.8430         0.1684         0.1684 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.5604 0.7984 0.9677 1.2329 2.8709</code></pre>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Acemoglu2001" class="csl-entry">
Acemoglu, D., S. Johnson, and J. Robinson. 2001. <span>“The Colonial Origins of Comparative Development: An Empirical Investigation.”</span> <em>The American Economic Review</em> 91 (5): 1369–1401.
</div>
<div id="ref-gujarati2009basic" class="csl-entry">
Gujarati, Damodar N., and Dawn C. Porter. 2009. <em>Basic Econometrics</em>. 5th ed. New York, NY: McGraw-Hill Education.
</div>
<div id="ref-koop2003bayesian" class="csl-entry">
Koop, Gary M. 2003. <em>Bayesian Econometrics</em>. John Wiley &amp; Sons Inc.
</div>
<div id="ref-wooldridge2016introductory" class="csl-entry">
Wooldridge, Jeffrey M. 2016. <em>Introductory Econometrics: A Modern Approach</em>. 6th ed. Boston, MA: Cengage Learning.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>This model captures the potential underlying economic relationship between the variables.<a href="sec71.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p> <em>Simultaneous causality</em> is one of the most controversial causation issues from a philosophy of science perspective. The root of the issue is that causation is typically based on the time sequence of cause and effect.<a href="sec71.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Note that <span class="math inline">\(\mathbb{E}[u_1\text{PAER}]\neq 0\)</span>, which means failing to meet a necessary condition for obtaining <em>unbiased</em> and <em>consistent</em> estimators of . See Exercise 1.<a href="sec71.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Good introductory-level textbooks on identification in linear systems include <span class="citation">Gujarati and Porter (<a href="#ref-gujarati2009basic">2009</a>)</span>, and <span class="citation">Jeffrey M. Wooldridge (<a href="#ref-wooldridge2016introductory">2016</a>)</span>.<a href="sec71.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Note that we are setting the priors in the <em>reduced-form</em> model. This may have unintended consequences for the posterior distributions of the <em>structural</em> parameters, which are ultimately the parameters of interest to researchers. For further discussion, see <span class="citation">Koop (<a href="#ref-koop2003bayesian">2003</a>)</span>.<a href="sec71.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chap7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec72.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/aramir21/IntroductionBayesianEconometricsBook/07-Multivariatereg.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
