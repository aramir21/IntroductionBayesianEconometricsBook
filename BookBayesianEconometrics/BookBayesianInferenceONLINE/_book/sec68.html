<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.8 Tobit model | Introduction to Bayesian Data Modeling</title>
  <meta name="description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5.8 Tobit model | Introduction to Bayesian Data Modeling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="github-repo" content="https://github.com/aramir21/IntroductionBayesianEconometricsBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.8 Tobit model | Introduction to Bayesian Data Modeling" />
  
  <meta name="twitter:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  

<meta name="author" content="Andrés Ramírez-Hassan" />


<meta name="date" content="2025-02-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="negative-binomial-model.html"/>
<link rel="next" href="sec69.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Bayesian Econometrics: A GUIded tour using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="to-instructors-and-students.html"><a href="to-instructors-and-students.html"><i class="fa fa-check"></i>To instructors and students</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Chap1.html"><a href="Chap1.html"><i class="fa fa-check"></i><b>1</b> Basic formal concepts</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sec11.html"><a href="sec11.html"><i class="fa fa-check"></i><b>1.1</b> The Bayes’ rule</a></li>
<li class="chapter" data-level="1.2" data-path="sec12.html"><a href="sec12.html"><i class="fa fa-check"></i><b>1.2</b> Bayesian framework: A brief summary of theory</a></li>
<li class="chapter" data-level="1.3" data-path="sec14.html"><a href="sec14.html"><i class="fa fa-check"></i><b>1.3</b> Bayesian reports: Decision theory under uncertainty</a></li>
<li class="chapter" data-level="1.4" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chap2.html"><a href="Chap2.html"><i class="fa fa-check"></i><b>2</b> Conceptual differences between the Bayesian and Frequentist approaches</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec21.html"><a href="sec21.html"><i class="fa fa-check"></i><b>2.1</b> The concept of probability</a></li>
<li class="chapter" data-level="2.2" data-path="sec22.html"><a href="sec22.html"><i class="fa fa-check"></i><b>2.2</b> Subjectivity is not the key</a></li>
<li class="chapter" data-level="2.3" data-path="sec23.html"><a href="sec23.html"><i class="fa fa-check"></i><b>2.3</b> Estimation, hypothesis testing and prediction</a></li>
<li class="chapter" data-level="2.4" data-path="sec24.html"><a href="sec24.html"><i class="fa fa-check"></i><b>2.4</b> The likelihood principle</a></li>
<li class="chapter" data-level="2.5" data-path="sec25.html"><a href="sec25.html"><i class="fa fa-check"></i><b>2.5</b> Why is not the Bayesian approach that popular?</a></li>
<li class="chapter" data-level="2.6" data-path="sec26.html"><a href="sec26.html"><i class="fa fa-check"></i><b>2.6</b> A simple working example</a></li>
<li class="chapter" data-level="2.7" data-path="sec27.html"><a href="sec27.html"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
<li class="chapter" data-level="2.8" data-path="sec28.html"><a href="sec28.html"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chap3.html"><a href="Chap3.html"><i class="fa fa-check"></i><b>3</b> Cornerstone models: Conjugate families</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec41.html"><a href="sec41.html"><i class="fa fa-check"></i><b>3.1</b> Motivation of conjugate families</a></li>
<li class="chapter" data-level="3.2" data-path="sec42.html"><a href="sec42.html"><i class="fa fa-check"></i><b>3.2</b> Conjugate prior to exponential family</a></li>
<li class="chapter" data-level="3.3" data-path="sec44.html"><a href="sec44.html"><i class="fa fa-check"></i><b>3.3</b> Linear regression: The conjugate normal-normal/inverse gamma model</a></li>
<li class="chapter" data-level="3.4" data-path="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><a href="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><i class="fa fa-check"></i><b>3.4</b> Multivariate linear regression: The conjugate normal-normal/inverse Wishart model</a></li>
<li class="chapter" data-level="3.5" data-path="computational-examples.html"><a href="computational-examples.html"><i class="fa fa-check"></i><b>3.5</b> Computational examples</a></li>
<li class="chapter" data-level="3.6" data-path="summary-chapter-4.html"><a href="summary-chapter-4.html"><i class="fa fa-check"></i><b>3.6</b> Summary: Chapter 4</a></li>
<li class="chapter" data-level="3.7" data-path="exercises-chapter-4.html"><a href="exercises-chapter-4.html"><i class="fa fa-check"></i><b>3.7</b> Exercises: Chapter 4</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chap5.html"><a href="Chap5.html"><i class="fa fa-check"></i><b>4</b> Graphical user interface</a></li>
<li class="chapter" data-level="5" data-path="Chap6.html"><a href="Chap6.html"><i class="fa fa-check"></i><b>5</b> Univariate regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec61.html"><a href="sec61.html"><i class="fa fa-check"></i><b>5.1</b> The Gaussian linear model</a></li>
<li class="chapter" data-level="5.2" data-path="sec62.html"><a href="sec62.html"><i class="fa fa-check"></i><b>5.2</b> The logit model</a></li>
<li class="chapter" data-level="5.3" data-path="sec63.html"><a href="sec63.html"><i class="fa fa-check"></i><b>5.3</b> The probit model</a></li>
<li class="chapter" data-level="5.4" data-path="sec64.html"><a href="sec64.html"><i class="fa fa-check"></i><b>5.4</b> The multinomial probit model</a></li>
<li class="chapter" data-level="5.5" data-path="sec65.html"><a href="sec65.html"><i class="fa fa-check"></i><b>5.5</b> The multinomial logit model</a></li>
<li class="chapter" data-level="5.6" data-path="sec66.html"><a href="sec66.html"><i class="fa fa-check"></i><b>5.6</b> Ordered probit model</a></li>
<li class="chapter" data-level="5.7" data-path="negative-binomial-model.html"><a href="negative-binomial-model.html"><i class="fa fa-check"></i><b>5.7</b> Negative binomial model</a></li>
<li class="chapter" data-level="5.8" data-path="sec68.html"><a href="sec68.html"><i class="fa fa-check"></i><b>5.8</b> Tobit model</a></li>
<li class="chapter" data-level="5.9" data-path="sec69.html"><a href="sec69.html"><i class="fa fa-check"></i><b>5.9</b> Quantile regression</a></li>
<li class="chapter" data-level="5.10" data-path="sec610.html"><a href="sec610.html"><i class="fa fa-check"></i><b>5.10</b> Bayesian bootstrap regression</a></li>
<li class="chapter" data-level="5.11" data-path="sec611.html"><a href="sec611.html"><i class="fa fa-check"></i><b>5.11</b> Summary</a></li>
<li class="chapter" data-level="5.12" data-path="sec612.html"><a href="sec612.html"><i class="fa fa-check"></i><b>5.12</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Chap7.html"><a href="Chap7.html"><i class="fa fa-check"></i><b>6</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec71.html"><a href="sec71.html"><i class="fa fa-check"></i><b>6.1</b> Multivariate regression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Chap8.html"><a href="Chap8.html"><i class="fa fa-check"></i><b>7</b> Time series</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Bayesian Data Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec68" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Tobit model<a href="sec68.html#sec68" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dependent variable is partially observed in Tobit models due to sampling schemes, whereas the regressors are completely observed. In particular,</p>
<p><span class="math display">\[\begin{equation}
    y_i = \begin{Bmatrix}
        L, &amp; \quad y_i^* &lt; L, \\
        y_i^*, &amp; \quad L \leq y_i^* &lt; U, \\
        U, &amp; \quad y_i^* \geq U,
    \end{Bmatrix}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(y_i^* \stackrel{i.i.d.}{\sim} N(\mathbf{x}_i^{\top} \boldsymbol{\beta}, \sigma^2)\)</span>, <span class="math inline">\(\mathbf{x}_i\)</span> is a <span class="math inline">\(K\)</span>-dimensional vector of regressors.<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a></p>
<p>We use conjugate independent priors <span class="math inline">\(\boldsymbol{\beta} \sim N(\boldsymbol{\beta}_0, \mathbf{B}_0)\)</span> and
<span class="math inline">\(\sigma^2 \sim IG(\alpha_0/2, \delta_0/2)\)</span>, and data augmentation using <span class="math inline">\(\mathbf{y}^*_C\)</span> such that <span class="math inline">\(y_{C_i}^* \stackrel{i.n.d.}{\thicksim} N(\mathbf{x}_i^{\top} \boldsymbol{\beta}, \sigma^2)\)</span>, <span class="math inline">\(y_{C_i} = \left\{ y_{C_i^L}^* \cup y_{C_i^U}^* \right\}\)</span> are lower and upper censored data. This allows implementing the Gibbs sampling algorithm <span class="citation">(<a href="#ref-Chib1992">S. Chib 1992</a>)</span>.</p>
<p>Then,</p>
<p><span class="math display">\[\begin{align}
\pi(\boldsymbol{\beta}, \sigma^2, \mathbf{y^*} \mid \mathbf{y}, \mathbf{X}) &amp;\propto \prod_{i=1}^N \left[ \mathbb{1}({y_i = L}) \mathbb{1}({y_{C_i^L}^* &lt; L}) + \mathbb{1}({L \leq y_i &lt; U}) + \mathbb{1}({y_i = U}) \mathbb{1}({y_{C_i^U}^* \geq U}) \right] \\
&amp;\times N(y_i^* \mid \mathbf{x}_i^{\top} \boldsymbol{\beta}, \sigma^2) \times N(\boldsymbol{\beta} \mid \boldsymbol{\beta}_0, \mathbf{B}_0) \times IG(\sigma^2 \mid \alpha_0/2, \delta_0/2)
\end{align}\]</span></p>
<p>The posterior distributions are:</p>
<p><span class="math display">\[\begin{equation}
    y_{C_i}^* \mid \boldsymbol{\beta}, \sigma^2, \mathbf{y}, \mathbf{X} \sim \begin{Bmatrix}
        TN_{(-\infty,L)}(\mathbf{x}_i^{\top}\boldsymbol{\beta}, \sigma^2) \ , \ y_i = L \\
        TN_{[U, \infty)}(\mathbf{x}_i^{\top}\boldsymbol{\beta}, \sigma^2) \ \ , \ y_i = U
    \end{Bmatrix}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \boldsymbol{\beta} \mid \sigma^2, \mathbf{y}, \mathbf{X} \sim N(\boldsymbol{\beta}_n, \sigma^2 \mathbf{B}_n)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \sigma^2 \mid \boldsymbol{\beta}, \mathbf{y}, \mathbf{X} \sim IG(\alpha_n/2, \delta_n/2)
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{B}_n = (\mathbf{B}_0^{-1} + \sigma^{-2} \mathbf{X}^{\top} \mathbf{X})^{-1}\)</span>, <span class="math inline">\(\boldsymbol{\beta}_n = \mathbf{B}_n(\mathbf{B}_0^{-1} \boldsymbol{\beta}_0 + \sigma^{-2} \mathbf{X}^{\top} \mathbf{y}^*)\)</span>, <span class="math inline">\(\alpha_n = \alpha_0 + N\)</span>, and <span class="math inline">\(\delta_n = \delta_0 + (\mathbf{y}^* - \mathbf{X} \boldsymbol{\beta})^{\top}(\mathbf{y}^* - \mathbf{X} \boldsymbol{\beta})\)</span>.</p>
<p><strong>Example: The market value of soccer players in Europe continues</strong></p>
<p>We continue with the example of the market value of soccer players from Section <a href="sec61.html#sec61">5.1</a>. We specify the same equation but assume that the sample is censored from below, such that we only have information for soccer players whose market value is higher than one million euros. The dependent variable is <em>log(ValueCens)</em>, and the left censoring point is 13.82.</p>
<p>The following Algorithm illustrates how to estimate Tobit models in our GUI. Our GUI utilizes the <em>MCMCtobit</em> command from the <em>MCMCpack</em> package.</p>
<div class="algorithm">
<div style="background-color: #f8f9fa; padding: 15px; border-left: 5px solid #343a40; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.1); border-radius: 5px;">
<p><strong>Algorithm: Tobit models</strong></p>
<ol style="list-style-type: decimal">
<li>Select <em>Univariate Models</em> on the top panel<br />
</li>
<li>Select <em>Tobit</em> model using the left radio button<br />
</li>
<li>Upload the dataset by first selecting whether there is a header in the file, and the kind of separator in the <em>csv</em> file of the dataset (comma, semicolon, or tab). Then, use the <em>Browse</em> button under the <strong>Choose File</strong> legend. You should see a preview of the dataset<br />
</li>
<li>Select MCMC iterations, burn-in, and thinning parameters using the <em>Range sliders</em><br />
</li>
<li>Select dependent and independent variables using the <em>Formula builder</em> table<br />
</li>
<li>Click the <em>Build formula</em> button to generate the formula in <strong>R</strong> syntax. You can modify the formula in the <strong>Main equation</strong> box using valid arguments of the <em>formula</em> command structure in <strong>R</strong><br />
</li>
<li>Set the left and right censoring points. To censor above only, specify <em>-Inf</em> in the left censoring box, and to censor below only, specify <em>Inf</em> in the right censoring box<br />
</li>
<li>Set the hyperparameters: mean vector, covariance matrix, shape, and scale parameters. This step is not necessary as by default our GUI uses non-informative priors<br />
</li>
<li>Click the <em>Go!</em> button<br />
</li>
<li>Analyze results<br />
</li>
<li>Download posterior chains and diagnostic plots using the <em>Download Posterior Chains</em> and <em>Download Posterior Graphs</em> buttons</li>
</ol>
</div>
</div>
<p>We run this application using the same hyperparameters that we set in the example of Section <a href="sec61.html#sec61">5.1</a>. All results seem similar to those in the example of linear models. In addition, the posterior chains seem to achieve good diagnostics.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sec68.html#cb136-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()); <span class="fu">set.seed</span>(<span class="dv">010101</span>)</span>
<span id="cb136-2"><a href="sec68.html#cb136-2" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/besmarter/BSTApp/refs/heads/master/DataApp/1ValueFootballPlayers.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb136-3"><a href="sec68.html#cb136-3" tabindex="-1"></a><span class="fu">attach</span>(Data)</span></code></pre></div>
<pre><code>## The following objects are masked from Data (pos = 3):
## 
##     Age, Age2</code></pre>
<pre><code>## The following objects are masked from mydata:
## 
##     Age, Age2</code></pre>
<pre><code>## The following objects are masked from Data (pos = 5):
## 
##     Age, Age2, Assists, Exp, Exp2, Goals, Goals2, NatTeam, Perf, Perf2,
##     Player, Value, ValueCens</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="sec68.html#cb140-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">log</span>(ValueCens) </span>
<span id="cb140-2"><a href="sec68.html#cb140-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, Perf, Age, Age2, NatTeam, Goals, Exp, Exp2)</span>
<span id="cb140-3"><a href="sec68.html#cb140-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb140-4"><a href="sec68.html#cb140-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>]</span>
<span id="cb140-5"><a href="sec68.html#cb140-5" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb140-6"><a href="sec68.html#cb140-6" tabindex="-1"></a>d0 <span class="ot">&lt;-</span> <span class="fl">0.001</span>; a0 <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb140-7"><a href="sec68.html#cb140-7" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k); c0 <span class="ot">&lt;-</span> <span class="dv">1000</span>; B0 <span class="ot">&lt;-</span> c0<span class="sc">*</span><span class="fu">diag</span>(k)</span>
<span id="cb140-8"><a href="sec68.html#cb140-8" tabindex="-1"></a>B0i <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0)</span>
<span id="cb140-9"><a href="sec68.html#cb140-9" tabindex="-1"></a><span class="co"># MCMC parameters</span></span>
<span id="cb140-10"><a href="sec68.html#cb140-10" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb140-11"><a href="sec68.html#cb140-11" tabindex="-1"></a>burnin <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb140-12"><a href="sec68.html#cb140-12" tabindex="-1"></a>tot <span class="ot">&lt;-</span> mcmc <span class="sc">+</span> burnin</span>
<span id="cb140-13"><a href="sec68.html#cb140-13" tabindex="-1"></a>thin <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb140-14"><a href="sec68.html#cb140-14" tabindex="-1"></a><span class="co"># Posterior distributions using packages: MCMCpack sets the model in terms of the precision matrix</span></span>
<span id="cb140-15"><a href="sec68.html#cb140-15" tabindex="-1"></a>posterior  <span class="ot">&lt;-</span> MCMCpack<span class="sc">::</span><span class="fu">MCMCtobit</span>(y<span class="sc">~</span>X<span class="dv">-1</span>, <span class="at">b0=</span>b0, <span class="at">B0 =</span> B0i, <span class="at">c0 =</span> a0, <span class="at">d0 =</span> d0, <span class="at">burnin =</span> burnin, <span class="at">mcmc =</span> mcmc, <span class="at">thin =</span> thin, <span class="at">below =</span> <span class="fl">13.82</span>, <span class="at">above =</span> <span class="cn">Inf</span>)</span>
<span id="cb140-16"><a href="sec68.html#cb140-16" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(posterior))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:50000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 50000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##               Mean       SD  Naive SE Time-series SE
## X         1.049702 2.639780 1.181e-02      1.676e-02
## XPerf     0.033979 0.004512 2.018e-05      2.288e-05
## XAge      1.024758 0.213319 9.540e-04      1.337e-03
## XAge2    -0.021861 0.004002 1.790e-05      2.546e-05
## XNatTeam  0.847758 0.126113 5.640e-04      6.463e-04
## XGoals    0.010091 0.001649 7.376e-06      7.688e-06
## XExp      0.174196 0.070237 3.141e-04      3.808e-04
## XExp2    -0.005652 0.002977 1.331e-05      1.555e-05
## sigma2    0.982768 0.095944 4.291e-04      6.698e-04
## 
## 2. Quantiles for each variable:
## 
##               2.5%       25%       50%       75%      97.5%
## X        -4.192313 -0.713326  1.071600  2.841806  6.1771087
## XPerf     0.025131  0.030948  0.033967  0.036976  0.0428691
## XAge      0.609991  0.880679  1.023709  1.167147  1.4480407
## XAge2    -0.029803 -0.024542 -0.021820 -0.019162 -0.0141026
## XNatTeam  0.603262  0.762408  0.847351  0.932705  1.0950039
## XGoals    0.006877  0.008975  0.010094  0.011193  0.0133502
## XExp      0.037752  0.126722  0.173706  0.221290  0.3127266
## XExp2    -0.011525 -0.007632 -0.005642 -0.003657  0.0001633
## sigma2    0.811752  0.915417  0.976781  1.042729  1.1887701</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="sec68.html#cb142-1" tabindex="-1"></a><span class="co"># Gibbs sampling functions</span></span>
<span id="cb142-2"><a href="sec68.html#cb142-2" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X</span>
<span id="cb142-3"><a href="sec68.html#cb142-3" tabindex="-1"></a>PostBeta <span class="ot">&lt;-</span> <span class="cf">function</span>(Yl, sig2){</span>
<span id="cb142-4"><a href="sec68.html#cb142-4" tabindex="-1"></a>    Bn <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0i <span class="sc">+</span> sig2<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>XtX)</span>
<span id="cb142-5"><a href="sec68.html#cb142-5" tabindex="-1"></a>    bn <span class="ot">&lt;-</span> Bn<span class="sc">%*%</span>(B0i<span class="sc">%*%</span>b0 <span class="sc">+</span> sig2<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Yl)</span>
<span id="cb142-6"><a href="sec68.html#cb142-6" tabindex="-1"></a>    Beta <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, bn, Bn)</span>
<span id="cb142-7"><a href="sec68.html#cb142-7" tabindex="-1"></a>    <span class="fu">return</span>(Beta)</span>
<span id="cb142-8"><a href="sec68.html#cb142-8" tabindex="-1"></a>}</span>
<span id="cb142-9"><a href="sec68.html#cb142-9" tabindex="-1"></a>PostYl <span class="ot">&lt;-</span> <span class="cf">function</span>(Beta, L, U, i){</span>
<span id="cb142-10"><a href="sec68.html#cb142-10" tabindex="-1"></a>    Ylmean <span class="ot">&lt;-</span> X[i,]<span class="sc">%*%</span>Beta</span>
<span id="cb142-11"><a href="sec68.html#cb142-11" tabindex="-1"></a>    <span class="cf">if</span>(y[i] <span class="sc">==</span> L){</span>
<span id="cb142-12"><a href="sec68.html#cb142-12" tabindex="-1"></a>        Yli <span class="ot">&lt;-</span> truncnorm<span class="sc">::</span><span class="fu">rtruncnorm</span>(<span class="dv">1</span>, <span class="at">a =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">b =</span> L, <span class="at">mean =</span> Ylmean, <span class="at">sd =</span> sig2<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb142-13"><a href="sec68.html#cb142-13" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb142-14"><a href="sec68.html#cb142-14" tabindex="-1"></a>        <span class="cf">if</span>(y[i] <span class="sc">==</span> U){</span>
<span id="cb142-15"><a href="sec68.html#cb142-15" tabindex="-1"></a>            Yli <span class="ot">&lt;-</span> truncnorm<span class="sc">::</span><span class="fu">rtruncnorm</span>(<span class="dv">1</span>, <span class="at">a =</span> U, <span class="at">b =</span> <span class="cn">Inf</span>, <span class="at">mean =</span> Ylmean, <span class="at">sd =</span> sig2<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb142-16"><a href="sec68.html#cb142-16" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb142-17"><a href="sec68.html#cb142-17" tabindex="-1"></a>            Yli <span class="ot">&lt;-</span> y[i]</span>
<span id="cb142-18"><a href="sec68.html#cb142-18" tabindex="-1"></a>        }</span>
<span id="cb142-19"><a href="sec68.html#cb142-19" tabindex="-1"></a>    }</span>
<span id="cb142-20"><a href="sec68.html#cb142-20" tabindex="-1"></a>    <span class="fu">return</span>(Yli)</span>
<span id="cb142-21"><a href="sec68.html#cb142-21" tabindex="-1"></a>}</span>
<span id="cb142-22"><a href="sec68.html#cb142-22" tabindex="-1"></a>PostSig2 <span class="ot">&lt;-</span> <span class="cf">function</span>(Beta, Yl){</span>
<span id="cb142-23"><a href="sec68.html#cb142-23" tabindex="-1"></a>    an <span class="ot">&lt;-</span> a0 <span class="sc">+</span> <span class="fu">length</span>(y)</span>
<span id="cb142-24"><a href="sec68.html#cb142-24" tabindex="-1"></a>    dn <span class="ot">&lt;-</span> d0 <span class="sc">+</span> <span class="fu">t</span>(Yl <span class="sc">-</span> X<span class="sc">%*%</span>Beta)<span class="sc">%*%</span>(Yl <span class="sc">-</span> X<span class="sc">%*%</span>Beta)</span>
<span id="cb142-25"><a href="sec68.html#cb142-25" tabindex="-1"></a>    sig2 <span class="ot">&lt;-</span> invgamma<span class="sc">::</span><span class="fu">rinvgamma</span>(<span class="dv">1</span>, <span class="at">shape =</span> an<span class="sc">/</span><span class="dv">2</span>, <span class="at">rate =</span> dn<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb142-26"><a href="sec68.html#cb142-26" tabindex="-1"></a>    <span class="fu">return</span>(sig2)</span>
<span id="cb142-27"><a href="sec68.html#cb142-27" tabindex="-1"></a>}</span>
<span id="cb142-28"><a href="sec68.html#cb142-28" tabindex="-1"></a>PostBetas <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, mcmc<span class="sc">+</span>burnin, k); Beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb142-29"><a href="sec68.html#cb142-29" tabindex="-1"></a>PostSigma2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, mcmc<span class="sc">+</span>burnin); sig2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb142-30"><a href="sec68.html#cb142-30" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1000000</span>); U <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb142-31"><a href="sec68.html#cb142-31" tabindex="-1"></a><span class="co"># create progress bar in case that you want to see iterations progress</span></span>
<span id="cb142-32"><a href="sec68.html#cb142-32" tabindex="-1"></a>pb <span class="ot">&lt;-</span> <span class="fu">winProgressBar</span>(<span class="at">title =</span> <span class="st">&quot;progress bar&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> tot, <span class="at">width =</span> <span class="dv">300</span>)</span>
<span id="cb142-33"><a href="sec68.html#cb142-33" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tot){</span>
<span id="cb142-34"><a href="sec68.html#cb142-34" tabindex="-1"></a>    Yl <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(i){<span class="fu">PostYl</span>(<span class="at">Beta =</span> Beta, <span class="at">L =</span> L, <span class="at">U =</span> U, i)})</span>
<span id="cb142-35"><a href="sec68.html#cb142-35" tabindex="-1"></a>    Beta <span class="ot">&lt;-</span> <span class="fu">PostBeta</span>(<span class="at">Yl =</span> Yl, sig2)</span>
<span id="cb142-36"><a href="sec68.html#cb142-36" tabindex="-1"></a>    sig2 <span class="ot">&lt;-</span> <span class="fu">PostSig2</span>(<span class="at">Beta =</span> Beta, <span class="at">Yl =</span> Yl) </span>
<span id="cb142-37"><a href="sec68.html#cb142-37" tabindex="-1"></a>    PostBetas[s,] <span class="ot">&lt;-</span> Beta; PostSigma2[s] <span class="ot">&lt;-</span> sig2</span>
<span id="cb142-38"><a href="sec68.html#cb142-38" tabindex="-1"></a>    <span class="fu">setWinProgressBar</span>(pb, s, <span class="at">title=</span><span class="fu">paste</span>( <span class="fu">round</span>(s<span class="sc">/</span>tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">0</span>), <span class="st">&quot;% done&quot;</span>))</span>
<span id="cb142-39"><a href="sec68.html#cb142-39" tabindex="-1"></a>}</span>
<span id="cb142-40"><a href="sec68.html#cb142-40" tabindex="-1"></a><span class="fu">close</span>(pb)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="sec68.html#cb144-1" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">seq</span>((burnin<span class="sc">+</span><span class="dv">1</span>), tot, thin)</span>
<span id="cb144-2"><a href="sec68.html#cb144-2" tabindex="-1"></a>PosteriorBetas <span class="ot">&lt;-</span> PostBetas[keep,]</span>
<span id="cb144-3"><a href="sec68.html#cb144-3" tabindex="-1"></a><span class="fu">colnames</span>(PosteriorBetas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Perf&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Age2&quot;</span>, <span class="st">&quot;NatTeam&quot;</span>, <span class="st">&quot;Goals&quot;</span>, <span class="st">&quot;Exp&quot;</span>, <span class="st">&quot;Exp2&quot;</span>)</span>
<span id="cb144-4"><a href="sec68.html#cb144-4" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(PosteriorBetas))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:50000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 50000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                Mean       SD  Naive SE Time-series SE
## Intercept  1.023783 2.640151 1.181e-02      1.649e-02
## Perf       0.033982 0.004496 2.011e-05      2.198e-05
## Age        1.026527 0.213505 9.548e-04      1.322e-03
## Age2      -0.021902 0.004005 1.791e-05      2.520e-05
## NatTeam    0.849435 0.125673 5.620e-04      6.394e-04
## Goals      0.010093 0.001652 7.390e-06      7.745e-06
## Exp        0.175137 0.070498 3.153e-04      3.877e-04
## Exp2      -0.005685 0.002985 1.335e-05      1.578e-05
## 
## 2. Quantiles for each variable:
## 
##                2.5%       25%       50%       75%      97.5%
## Intercept -4.218202 -0.737377  1.048790  2.818320  6.1265295
## Perf       0.025253  0.030947  0.033956  0.036986  0.0428926
## Age        0.612543  0.881473  1.024929  1.169122  1.4478207
## Age2      -0.029837 -0.024583 -0.021874 -0.019170 -0.0141402
## NatTeam    0.603543  0.764706  0.849179  0.933046  1.0994449
## Goals      0.006808  0.008979  0.010097  0.011208  0.0133334
## Exp        0.038449  0.127461  0.174294  0.223045  0.3138970
## Exp2      -0.011563 -0.007695 -0.005659 -0.003663  0.0001001</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="sec68.html#cb146-1" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(PostSigma2[keep]))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:50000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 50000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##      0.9860750      0.0963754      0.0004310      0.0006757 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.8156 0.9186 0.9792 1.0469 1.1937</code></pre>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Chib1992" class="csl-entry">
Chib, S. 1992. <span>“Bayes Inference in the <span>T</span>obit Censored Regression Model.”</span> <em>Journal of Econometrics</em> 51: 79–99.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="29">
<li id="fn29"><p>We can set <span class="math inline">\(L\)</span> or <span class="math inline">\(U\)</span> equal to <span class="math inline">\(-\infty\)</span> or <span class="math inline">\(\infty\)</span> to model data censored on just one side.<a href="sec68.html#fnref29" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="negative-binomial-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec69.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aramir21/IntroductionBayesianEconometricsBook/06-Univariatereg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
