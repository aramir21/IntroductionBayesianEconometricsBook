<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.1 Normal model | Introduction to Bayesian Data Modeling</title>
  <meta name="description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="7.1 Normal model | Introduction to Bayesian Data Modeling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="github-repo" content="https://github.com/aramir21/IntroductionBayesianEconometricsBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.1 Normal model | Introduction to Bayesian Data Modeling" />
  
  <meta name="twitter:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  

<meta name="author" content="Andrés Ramírez-Hassan" />


<meta name="date" content="2025-02-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="unireg.html"/>
<link rel="next" href="logit-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Bayesian Econometrics: A GUIded tour using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1</b> About Me</a>
<ul>
<li class="chapter" data-level="1.1" data-path="besmarter.html"><a href="besmarter.html"><i class="fa fa-check"></i><b>1.1</b> BEsmarter</a></li>
<li class="chapter" data-level="1.2" data-path="contact.html"><a href="contact.html"><i class="fa fa-check"></i><b>1.2</b> Contact</a></li>
<li class="chapter" data-level="1.3" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="to-instructors-and-students.html"><a href="to-instructors-and-students.html"><i class="fa fa-check"></i>To instructors and students</a></li>
<li class="chapter" data-level="" data-path="a-brief-presentation-of-r-software.html"><a href="a-brief-presentation-of-r-software.html"><i class="fa fa-check"></i>A brief presentation of R software</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basic formal concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec11.html"><a href="sec11.html"><i class="fa fa-check"></i><b>2.1</b> The Bayes’ rule</a></li>
<li class="chapter" data-level="2.2" data-path="sec12.html"><a href="sec12.html"><i class="fa fa-check"></i><b>2.2</b> Bayesian framework: A brief summary of theory</a></li>
<li class="chapter" data-level="2.3" data-path="sec13.html"><a href="sec13.html"><i class="fa fa-check"></i><b>2.3</b> Bayesian reports: Decision theory under uncertainty</a></li>
<li class="chapter" data-level="2.4" data-path="summary-chapter-1.html"><a href="summary-chapter-1.html"><i class="fa fa-check"></i><b>2.4</b> Summary: Chapter 1</a></li>
<li class="chapter" data-level="2.5" data-path="exercises-chapter-1.html"><a href="exercises-chapter-1.html"><i class="fa fa-check"></i><b>2.5</b> Exercises: Chapter 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayfre.html"><a href="bayfre.html"><i class="fa fa-check"></i><b>3</b> Conceptual differences: Bayesian and Frequentist approaches</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec21.html"><a href="sec21.html"><i class="fa fa-check"></i><b>3.1</b> The concept of probability</a></li>
<li class="chapter" data-level="3.2" data-path="sec22.html"><a href="sec22.html"><i class="fa fa-check"></i><b>3.2</b> Subjectivity is not the key</a></li>
<li class="chapter" data-level="3.3" data-path="sec23.html"><a href="sec23.html"><i class="fa fa-check"></i><b>3.3</b> Estimation, hypothesis testing and prediction</a></li>
<li class="chapter" data-level="3.4" data-path="sec24.html"><a href="sec24.html"><i class="fa fa-check"></i><b>3.4</b> The likelihood principle</a></li>
<li class="chapter" data-level="3.5" data-path="sec25.html"><a href="sec25.html"><i class="fa fa-check"></i><b>3.5</b> Why is not the Bayesian approach that popular?</a></li>
<li class="chapter" data-level="3.6" data-path="sec26.html"><a href="sec26.html"><i class="fa fa-check"></i><b>3.6</b> A simple working example</a></li>
<li class="chapter" data-level="3.7" data-path="sec27.html"><a href="sec27.html"><i class="fa fa-check"></i><b>3.7</b> Summary: Chapter 2</a></li>
<li class="chapter" data-level="3.8" data-path="exercises-chapter-2.html"><a href="exercises-chapter-2.html"><i class="fa fa-check"></i><b>3.8</b> Exercises: Chapter 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="objsub.html"><a href="objsub.html"><i class="fa fa-check"></i><b>4</b> Objective and subjective Bayesian approaches</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec31.html"><a href="sec31.html"><i class="fa fa-check"></i><b>4.1</b> Objective Bayesian priors</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sec31.html"><a href="sec31.html#empirical-bayes"><i class="fa fa-check"></i><b>4.1.1</b> Empirical Bayes</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec32.html"><a href="sec32.html"><i class="fa fa-check"></i><b>4.2</b> Subjective Bayesian priors</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sec32.html"><a href="sec32.html#human-heuristics"><i class="fa fa-check"></i><b>4.2.1</b> Human heuristics</a></li>
<li class="chapter" data-level="4.2.2" data-path="sec32.html"><a href="sec32.html#elicitation"><i class="fa fa-check"></i><b>4.2.2</b> Elicitation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conjfam.html"><a href="conjfam.html"><i class="fa fa-check"></i><b>5</b> Cornerstone models: Conjugate families</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec41.html"><a href="sec41.html"><i class="fa fa-check"></i><b>5.1</b> Motivation of conjugate families</a></li>
<li class="chapter" data-level="5.2" data-path="sec42.html"><a href="sec42.html"><i class="fa fa-check"></i><b>5.2</b> Conjugate prior to exponential family</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression-the-conjugate-normal-normalinverse-gamma-model.html"><a href="linear-regression-the-conjugate-normal-normalinverse-gamma-model.html"><i class="fa fa-check"></i><b>5.3</b> Linear regression: The conjugate normal-normal/inverse gamma model</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><a href="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><i class="fa fa-check"></i><b>5.4</b> Multivariate linear regression: The conjugate normal-normal/inverse Wishart model</a></li>
<li class="chapter" data-level="5.5" data-path="computational-examples.html"><a href="computational-examples.html"><i class="fa fa-check"></i><b>5.5</b> Computational examples</a></li>
<li class="chapter" data-level="5.6" data-path="summary-chapter-4.html"><a href="summary-chapter-4.html"><i class="fa fa-check"></i><b>5.6</b> Summary: Chapter 4</a></li>
<li class="chapter" data-level="5.7" data-path="exercises-chapter-4.html"><a href="exercises-chapter-4.html"><i class="fa fa-check"></i><b>5.7</b> Exercises: Chapter 4</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sim.html"><a href="sim.html"><i class="fa fa-check"></i><b>6</b> Simulation methods</a></li>
<li class="chapter" data-level="7" data-path="unireg.html"><a href="unireg.html"><i class="fa fa-check"></i><b>7</b> Univariate regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="normal-model.html"><a href="normal-model.html"><i class="fa fa-check"></i><b>7.1</b> Normal model</a></li>
<li class="chapter" data-level="7.2" data-path="logit-model.html"><a href="logit-model.html"><i class="fa fa-check"></i><b>7.2</b> Logit model</a></li>
<li class="chapter" data-level="7.3" data-path="probit-model.html"><a href="probit-model.html"><i class="fa fa-check"></i><b>7.3</b> Probit model</a></li>
<li class="chapter" data-level="7.4" data-path="summary-chapter-6.html"><a href="summary-chapter-6.html"><i class="fa fa-check"></i><b>7.4</b> Summary: Chapter 6</a></li>
<li class="chapter" data-level="7.5" data-path="exercises-chapter-6.html"><a href="exercises-chapter-6.html"><i class="fa fa-check"></i><b>7.5</b> Exercises: Chapter 6</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>8</b> Multivariate regression</a></li>
<li class="chapter" data-level="9" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>9</b> Time series</a></li>
<li class="chapter" data-level="10" data-path="longi.html"><a href="longi.html"><i class="fa fa-check"></i><b>10</b> Longitudinal regression</a></li>
<li class="chapter" data-level="11" data-path="diag.html"><a href="diag.html"><i class="fa fa-check"></i><b>11</b> Convergence diagnostics</a></li>
<li class="chapter" data-level="12" data-path="bma.html"><a href="bma.html"><i class="fa fa-check"></i><b>12</b> Bayesian model averaging in variable selection</a></li>
<li class="chapter" data-level="13" data-path="nonpara.html"><a href="nonpara.html"><i class="fa fa-check"></i><b>13</b> Nonparametric regression</a></li>
<li class="chapter" data-level="14" data-path="recent.html"><a href="recent.html"><i class="fa fa-check"></i><b>14</b> Recent developments</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Bayesian Data Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="normal-model" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Normal model<a href="normal-model.html#normal-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Gaussian linear model specifies <span class="math inline">\({\bf{y}}={\bf{X}}\beta+\bf{\mu}\)</span> such that <span class="math inline">\(\bf{\mu}\sim N(\bf{0},\sigma^2\bf{I}_N)\)</span> is an stochastic error, <span class="math inline">\({\bf{X}}\)</span> is a <span class="math inline">\(N \times K\)</span> matrix of regressors, <span class="math inline">\(\beta\)</span> is a <span class="math inline">\(K\)</span>-dimensional vector of coefficients, <span class="math inline">\({\bf{y}}\)</span> is an <span class="math inline">\(N\)</span>-dimensional vector of a dependent variable, and <span class="math inline">\(N\)</span> is the number of units.</p>
<p>The conjugate independent priors for the parameters are
<span class="math inline">\(\beta \sim N(\beta_0, {\bf{B}}_0)\)</span> and
<span class="math inline">\(\sigma^2 \sim IG(\alpha_0/2, \delta_0/2)\)</span>. Given the likelihood function, <span class="math inline">\(p(\beta, \sigma^2|{\bf{y}}, {\bf{X}}) = (2\pi\sigma^2)^{-\frac{N}{2}} \exp \left\{-\frac{1}{2\sigma^2} ({\bf{y}} - \bf{X\beta})^{\top}({\bf{y}} - \bf{X\beta}) \right\}\)</span>, the conditional posterior distributions are</p>
<p><span class="math display">\[\begin{align}
\beta|\sigma^2, {\bf{y}}, {\bf{X}} \sim N(\beta_n, \sigma^2{\bf{B}}_n),
\end{align}\]</span>
and
<span class="math display">\[\begin{align}
\sigma^2|\beta, {\bf{y}}, {\bf{X}} \sim IG(\alpha_n/2, \delta_n/2),
\end{align}\]</span></p>
<p>where <span class="math inline">\({\bf{B}}_n = ({\bf{B}}_0^{-1} + \sigma^{-2} {\bf{X}}^{\top}{\bf{X}})^{-1}\)</span>, <span class="math inline">\(\beta_n= {\bf{B}}_n({\bf{B}}_0^{-1}\beta_0 + \sigma^{-2} {\bf{X}}^{\top}{\bf{y}})\)</span>, <span class="math inline">\(\alpha_n = \alpha_0 + N\)</span> and <span class="math inline">\(\delta_n = \delta_0 + ({\bf{y}}-{\bf{X}}\beta)^{\top}({\bf{y}}-{\bf{X}}\beta)\)</span>.</p>
<p>We can employ the Gibbs sampler in this model due to having standard conditional posterior distributions.</p>
<p><strong>Application: The market value of soccer players in Europe</strong></p>
<p>Let’s analyze the determinants of the market value of soccer players. In particular, we use the dataset <em>1ValueFootballPlayers.csv</em> which is in folder <em>DataApp</em> (see Table <a href="appendix.html#tab:tabDataApp">14.3</a> for details) in our github repository <a href="https://github.com/besmarter/BSTApp">(https://github.com/besmarter/BSTApp)</a>. This dataset was used by <span class="citation">(<a href="#ref-Serna2018">Serna Rodríguez, Ramírez Hassan, and Coad 2019</a>)</span> to finding the determinants of high performance soccer players in the five most important national leagues in Europe.</p>
<p>The specification of the model is</p>
<p><span class="math display">\[\begin{align}
\log(\text{Value}_i)&amp;=\beta_1+\beta_2\text{Perf}_i+\beta_3\text{Perf}^2_i+\beta_4\text{Age}_i+\beta_5\text{Age}^2_i+\beta_6\text{NatTeam}_i+\beta_7\text{Goals}_i\\
&amp;+\beta_8\text{Goals}^2_i+\beta_9\text{Exp}_i+\beta_{10}\text{Exp}^2_i+\beta_{11}\text{Assists}_i,
\end{align}\]</span></p>
<p>where <em>Value</em> is the market value in Euros (2017), <em>Perf</em> is a measure of performance, <em>Age</em> is the players’ age in years, <em>NatTem</em> is an indicator variable that takes the value of 1 if the player has been on the national team, <em>Goals</em> is the number of goals scored by the player during his career, <em>Exp</em> is his experience in years, and <em>Assists</em> is the number of assist made by the player in the 2015–2016 season.</p>
<p>We assume that the dependent variable distributes normal, then we use a normal-inverse gamma model using vague conjugate priors where <span class="math inline">\({\bf{B}}_0=1000{\bf{I}}_{10}\)</span>, <span class="math inline">\(\beta_0={\bf{0}}_{10}\)</span>, <span class="math inline">\(\alpha_0=0.001\)</span> and <span class="math inline">\(\delta_0=0.001\)</span>. We perform a Gibbs sampler with 10,000 MCMC iterations plus a burn-in equal to 5,000, and a thinning parameter equal to 1.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="normal-model.html#cb78-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">010101</span>) <span class="co"># Set a seed for replicability of results</span></span>
<span id="cb78-2"><a href="normal-model.html#cb78-2" tabindex="-1"></a><span class="co"># Download data from github</span></span>
<span id="cb78-3"><a href="normal-model.html#cb78-3" tabindex="-1"></a><span class="co"># urlfile &lt;- &#39;https://raw.githubusercontent.com/besmarter/BSTApp/master/DataApp/1ValueFootballPlayers.csv&#39;</span></span>
<span id="cb78-4"><a href="normal-model.html#cb78-4" tabindex="-1"></a><span class="co"># mydata &lt;- read.csv(urlfile)</span></span>
<span id="cb78-5"><a href="normal-model.html#cb78-5" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataApplications/1ValueFootballPlayers.csv&quot;</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb78-6"><a href="normal-model.html#cb78-6" tabindex="-1"></a><span class="fu">attach</span>(mydata)</span>
<span id="cb78-7"><a href="normal-model.html#cb78-7" tabindex="-1"></a><span class="fu">str</span>(mydata)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    335 obs. of  13 variables:
##  $ Player   : chr  &quot;Marc-Andr\xe9 ter Stegen&quot; &quot;Aleix Vidal&quot; &quot;Denis Su\xe1rez&quot; &quot;Rafinha&quot; ...
##  $ Value    : int  22000000 7500000 18000000 15000000 18000000 25000000 40000000 30000000 55000000 9000000 ...
##  $ ValueCens: int  22000000 7500000 18000000 15000000 18000000 25000000 40000000 30000000 55000000 9000000 ...
##  $ Perf     : int  7 9 33 6 34 25 31 12 35 29 ...
##  $ Perf2    : int  49 81 1089 36 1156 625 961 144 1225 841 ...
##  $ Age      : int  24 27 23 24 30 22 31 26 25 29 ...
##  $ Age2     : int  576 729 529 576 900 484 961 676 625 841 ...
##  $ NatTeam  : int  1 1 1 1 1 1 1 1 1 0 ...
##  $ Goals    : int  0 27 27 34 0 18 26 8 28 43 ...
##  $ Goals2   : int  0 729 729 1156 0 324 676 64 784 1849 ...
##  $ Exp      : num  10.01 16.01 7.01 8.01 12.01 ...
##  $ Exp2     : num  100.2 256.4 49.1 64.1 144.2 ...
##  $ Assists  : int  0 0 4 1 0 0 1 0 5 7 ...</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="normal-model.html#cb80-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">log</span>(Value) <span class="co"># Dependent variable</span></span>
<span id="cb80-2"><a href="normal-model.html#cb80-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,<span class="fu">as.matrix</span>(mydata[, <span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>])) <span class="co"># Regressors</span></span>
<span id="cb80-3"><a href="normal-model.html#cb80-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>] <span class="co"># Sample size</span></span>
<span id="cb80-4"><a href="normal-model.html#cb80-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>] <span class="co"># Number of regressors including a constant</span></span>
<span id="cb80-5"><a href="normal-model.html#cb80-5" tabindex="-1"></a></span>
<span id="cb80-6"><a href="normal-model.html#cb80-6" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb80-7"><a href="normal-model.html#cb80-7" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">diag</span>(K) <span class="co"># Prior covariance matrix Normal distribution</span></span>
<span id="cb80-8"><a href="normal-model.html#cb80-8" tabindex="-1"></a>B0i <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0) <span class="co"># Prior precision matrix Normal distribution </span></span>
<span id="cb80-9"><a href="normal-model.html#cb80-9" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,K) <span class="co"># Prior mean Normal distribution</span></span>
<span id="cb80-10"><a href="normal-model.html#cb80-10" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="fl">0.001</span> <span class="co"># Prior shape parameter inverse-gamma distribution</span></span>
<span id="cb80-11"><a href="normal-model.html#cb80-11" tabindex="-1"></a>d0 <span class="ot">&lt;-</span> <span class="fl">0.001</span> <span class="co"># Prior rate parameter inverse-gamma distribution </span></span>
<span id="cb80-12"><a href="normal-model.html#cb80-12" tabindex="-1"></a></span>
<span id="cb80-13"><a href="normal-model.html#cb80-13" tabindex="-1"></a><span class="co"># MCMC parameters</span></span>
<span id="cb80-14"><a href="normal-model.html#cb80-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Iterations after burn-in</span></span>
<span id="cb80-15"><a href="normal-model.html#cb80-15" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Burn-in</span></span>
<span id="cb80-16"><a href="normal-model.html#cb80-16" tabindex="-1"></a>tot <span class="ot">&lt;-</span> burn <span class="sc">+</span> it <span class="co"># Total iterations</span></span>
<span id="cb80-17"><a href="normal-model.html#cb80-17" tabindex="-1"></a></span>
<span id="cb80-18"><a href="normal-model.html#cb80-18" tabindex="-1"></a><span class="do">###### 1. Programming the Gibbs sampler #######</span></span>
<span id="cb80-19"><a href="normal-model.html#cb80-19" tabindex="-1"></a><span class="co"># Space and initial setting</span></span>
<span id="cb80-20"><a href="normal-model.html#cb80-20" tabindex="-1"></a>betaGibbs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,tot,K) <span class="co"># Space for posterior beta</span></span>
<span id="cb80-21"><a href="normal-model.html#cb80-21" tabindex="-1"></a>varGibbs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,tot,<span class="dv">1</span>) <span class="co"># Space for posterior sigma^2</span></span>
<span id="cb80-22"><a href="normal-model.html#cb80-22" tabindex="-1"></a>sigma2_0 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Initial sigma^2</span></span>
<span id="cb80-23"><a href="normal-model.html#cb80-23" tabindex="-1"></a>Bn <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0i<span class="sc">+</span>sigma2_0<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="fu">t</span>(X)<span class="sc">%*%</span>X) <span class="co"># Initial covariance matrix beta</span></span>
<span id="cb80-24"><a href="normal-model.html#cb80-24" tabindex="-1"></a>bn <span class="ot">&lt;-</span> Bn<span class="sc">%*%</span>(B0i<span class="sc">%*%</span>b0<span class="sc">+</span>sigma2_0<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y) <span class="co"># Initial mean beta</span></span>
<span id="cb80-25"><a href="normal-model.html#cb80-25" tabindex="-1"></a>an <span class="ot">&lt;-</span> a0<span class="sc">+</span>N <span class="co"># Posterior alpha</span></span>
<span id="cb80-26"><a href="normal-model.html#cb80-26" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tot){</span>
<span id="cb80-27"><a href="normal-model.html#cb80-27" tabindex="-1"></a>  BetaG <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, <span class="at">mu=</span>bn, <span class="at">Sigma=</span>Bn) <span class="co"># Draw of posterior beta</span></span>
<span id="cb80-28"><a href="normal-model.html#cb80-28" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> d0<span class="sc">+</span><span class="fu">t</span>(y<span class="sc">-</span>X<span class="sc">%*%</span>BetaG)<span class="sc">%*%</span>(y<span class="sc">-</span>X<span class="sc">%*%</span>BetaG) <span class="co"># Posterior delta</span></span>
<span id="cb80-29"><a href="normal-model.html#cb80-29" tabindex="-1"></a>  sigma2 <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">rigamma</span>(<span class="dv">1</span>,an<span class="sc">/</span><span class="dv">2</span>,dn<span class="sc">/</span><span class="dv">2</span>) <span class="co"># Draw of posterior variance</span></span>
<span id="cb80-30"><a href="normal-model.html#cb80-30" tabindex="-1"></a>  Bn <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0i<span class="sc">+</span>sigma2<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="fu">t</span>(X)<span class="sc">%*%</span>X) <span class="co"># Posterior covariance beta</span></span>
<span id="cb80-31"><a href="normal-model.html#cb80-31" tabindex="-1"></a>  bn <span class="ot">&lt;-</span> Bn<span class="sc">%*%</span>(B0i<span class="sc">%*%</span>b0<span class="sc">+</span>sigma2<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span><span class="fu">t</span>(X)<span class="sc">%*%</span>y) <span class="co"># Posterior mean beta</span></span>
<span id="cb80-32"><a href="normal-model.html#cb80-32" tabindex="-1"></a>  betaGibbs[i,] <span class="ot">&lt;-</span> BetaG</span>
<span id="cb80-33"><a href="normal-model.html#cb80-33" tabindex="-1"></a>  varGibbs[i,] <span class="ot">&lt;-</span> sigma2</span>
<span id="cb80-34"><a href="normal-model.html#cb80-34" tabindex="-1"></a>}</span>
<span id="cb80-35"><a href="normal-model.html#cb80-35" tabindex="-1"></a><span class="co"># Draws after burn-in</span></span>
<span id="cb80-36"><a href="normal-model.html#cb80-36" tabindex="-1"></a>PostPar <span class="ot">&lt;-</span> coda<span class="sc">::</span><span class="fu">mcmc</span>(<span class="fu">cbind</span>(betaGibbs[burn<span class="sc">:</span>it,], varGibbs[burn<span class="sc">:</span>it,]))</span>
<span id="cb80-37"><a href="normal-model.html#cb80-37" tabindex="-1"></a><span class="co"># Names</span></span>
<span id="cb80-38"><a href="normal-model.html#cb80-38" tabindex="-1"></a><span class="fu">colnames</span>(PostPar) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Cte&quot;</span>, <span class="fu">names</span>(mydata)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb80-39"><a href="normal-model.html#cb80-39" tabindex="-1"></a><span class="co"># Summary posterior draws</span></span>
<span id="cb80-40"><a href="normal-model.html#cb80-40" tabindex="-1"></a><span class="fu">summary</span>(PostPar) </span></code></pre></div>
<pre><code>## 
## Iterations = 1:5001
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 5001 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                Mean        SD  Naive SE Time-series SE
## Cte       3.719e+00 2.202e+00 3.114e-02      3.183e-02
## Perf      2.822e-02 1.658e-02 2.344e-04      2.344e-04
## Perf2     1.535e-04 4.990e-04 7.056e-06      7.056e-06
## Age       7.747e-01 1.791e-01 2.533e-03      2.587e-03
## Age2     -1.647e-02 3.339e-03 4.722e-05      4.838e-05
## NatTeam   8.492e-01 1.177e-01 1.664e-03      1.700e-03
## Goals     1.168e-02 3.510e-03 4.963e-05      4.963e-05
## Goals2   -2.403e-05 1.874e-05 2.650e-07      2.650e-07
## Exp       2.012e-01 6.271e-02 8.867e-04      8.867e-04
## Exp2     -6.869e-03 2.706e-03 3.826e-05      3.826e-05
## Assists   2.014e-02 2.426e-02 3.431e-04      3.431e-04
## Variance  9.745e-01 7.619e-02 1.077e-03      1.112e-03
## 
## 2. Quantiles for each variable:
## 
##                2.5%        25%        50%        75%      97.5%
## Cte      -6.569e-01  2.241e+00  3.742e+00  5.169e+00  7.974e+00
## Perf     -4.031e-03  1.680e-02  2.813e-02  3.950e-02  6.068e-02
## Perf2    -8.073e-04 -1.846e-04  1.637e-04  4.975e-04  1.140e-03
## Age       4.235e-01  6.541e-01  7.724e-01  8.943e-01  1.131e+00
## Age2     -2.301e-02 -1.871e-02 -1.642e-02 -1.418e-02 -9.996e-03
## NatTeam   6.218e-01  7.695e-01  8.493e-01  9.298e-01  1.081e+00
## Goals     4.785e-03  9.291e-03  1.166e-02  1.409e-02  1.861e-02
## Goals2   -6.119e-05 -3.636e-05 -2.408e-05 -1.183e-05  1.265e-05
## Exp       8.048e-02  1.584e-01  1.998e-01  2.439e-01  3.266e-01
## Exp2     -1.223e-02 -8.683e-03 -6.852e-03 -5.073e-03 -1.647e-03
## Assists  -2.717e-02  3.785e-03  2.023e-02  3.698e-02  6.744e-02
## Variance  8.347e-01  9.219e-01  9.701e-01  1.026e+00  1.132e+00</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="normal-model.html#cb82-1" tabindex="-1"></a><span class="co"># Trace and density plots</span></span>
<span id="cb82-2"><a href="normal-model.html#cb82-2" tabindex="-1"></a><span class="fu">plot</span>(PostPar)</span></code></pre></div>
<p><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-1..svg" width="672" /><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-2..svg" width="672" /><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-3..svg" width="672" /><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-4..svg" width="672" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="normal-model.html#cb83-1" tabindex="-1"></a><span class="co"># Autocorrelation plots</span></span>
<span id="cb83-2"><a href="normal-model.html#cb83-2" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">autocorr.plot</span>(PostPar)</span></code></pre></div>
<p><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-5..svg" width="672" /><img src="BayesianEconometrics_files/figure-html/unnamed-chunk-16-6..svg" width="672" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="normal-model.html#cb84-1" tabindex="-1"></a><span class="co"># Convergence diagnostics</span></span>
<span id="cb84-2"><a href="normal-model.html#cb84-2" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">geweke.diag</span>(PostPar)</span></code></pre></div>
<pre><code>## 
## Fraction in 1st window = 0.1
## Fraction in 2nd window = 0.5 
## 
##      Cte     Perf    Perf2      Age     Age2  NatTeam    Goals   Goals2 
## -1.04762  1.80315 -1.83670  0.74901 -0.51896 -0.15252 -0.84002  0.80934 
##      Exp     Exp2  Assists Variance 
##  0.55521 -1.12322 -0.08184  0.78780</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="normal-model.html#cb86-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">raftery.diag</span>(PostPar,<span class="at">q=</span><span class="fl">0.5</span>,<span class="at">r=</span><span class="fl">0.025</span>,<span class="at">s =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
## Quantile (q) = 0.5
## Accuracy (r) = +/- 0.025
## Probability (s) = 0.95 
##                                                 
##           Burn-in  Total Lower bound  Dependence
##           (M)      (N)   (Nmin)       factor (I)
##  Cte      2        1561  1537         1.020     
##  Perf     2        1513  1537         0.984     
##  Perf2    2        1558  1537         1.010     
##  Age      1        1543  1537         1.000     
##  Age2     2        1578  1537         1.030     
##  NatTeam  2        1593  1537         1.040     
##  Goals    2        1578  1537         1.030     
##  Goals2   1        1541  1537         1.000     
##  Exp      2        1558  1537         1.010     
##  Exp2     2        1560  1537         1.010     
##  Assists  2        1578  1537         1.030     
##  Variance 2        1589  1537         1.030</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="normal-model.html#cb88-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">heidel.diag</span>(PostPar)</span></code></pre></div>
<pre><code>##                                        
##          Stationarity start     p-value
##          test         iteration        
## Cte      passed       1         0.795  
## Perf     passed       1         0.121  
## Perf2    passed       1         0.121  
## Age      passed       1         0.717  
## Age2     passed       1         0.642  
## NatTeam  passed       1         0.903  
## Goals    passed       1         0.400  
## Goals2   passed       1         0.642  
## Exp      passed       1         0.289  
## Exp2     passed       1         0.089  
## Assists  passed       1         0.290  
## Variance passed       1         0.743  
##                                       
##          Halfwidth Mean      Halfwidth
##          test                         
## Cte      passed     3.719381 6.24e-02 
## Perf     passed     0.028224 4.59e-04 
## Perf2    passed     0.000154 1.38e-05 
## Age      passed     0.774678 5.07e-03 
## Age2     passed    -0.016471 9.48e-05 
## NatTeam  passed     0.849176 3.33e-03 
## Goals    passed     0.011677 9.73e-05 
## Goals2   passed    -0.000024 5.19e-07 
## Exp      passed     0.201168 1.74e-03 
## Exp2     passed    -0.006869 7.50e-05 
## Assists  passed     0.020141 6.72e-04 
## Variance passed     0.974502 2.18e-03</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="normal-model.html#cb90-1" tabindex="-1"></a><span class="do">###### 2. Using a library: MCMCpack #######</span></span>
<span id="cb90-2"><a href="normal-model.html#cb90-2" tabindex="-1"></a>Reg <span class="ot">&lt;-</span> MCMCpack<span class="sc">::</span><span class="fu">MCMCregress</span>(y<span class="sc">~</span>X<span class="dv">-1</span>, <span class="at">burnin =</span> burn, <span class="at">mcmc =</span> it, <span class="at">b0 =</span> b0, <span class="at">B0 =</span> B0i, <span class="at">c0 =</span> a0, <span class="at">d0 =</span> d0)</span>
<span id="cb90-3"><a href="normal-model.html#cb90-3" tabindex="-1"></a><span class="fu">summary</span>(Reg)</span></code></pre></div>
<pre><code>## 
## Iterations = 5001:15000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                Mean        SD  Naive SE Time-series SE
## X         3.711e+00 2.230e+00 2.230e-02      2.230e-02
## XPerf     2.784e-02 1.643e-02 1.643e-04      1.643e-04
## XPerf2    1.629e-04 4.938e-04 4.938e-06      4.938e-06
## XAge      7.754e-01 1.816e-01 1.816e-03      1.816e-03
## XAge2    -1.648e-02 3.383e-03 3.383e-05      3.383e-05
## XNatTeam  8.500e-01 1.181e-01 1.181e-03      1.201e-03
## XGoals    1.175e-02 3.468e-03 3.468e-05      3.468e-05
## XGoals2  -2.447e-05 1.865e-05 1.865e-07      1.865e-07
## XExp      2.005e-01 6.295e-02 6.295e-04      6.295e-04
## XExp2    -6.830e-03 2.726e-03 2.726e-05      2.726e-05
## XAssists  2.015e-02 2.468e-02 2.468e-04      2.468e-04
## sigma2    9.739e-01 7.696e-02 7.696e-04      7.967e-04
## 
## 2. Quantiles for each variable:
## 
##                2.5%        25%        50%        75%      97.5%
## X        -6.129e-01  2.178e+00  3.692e+00  5.207e+00  8.100e+00
## XPerf    -4.408e-03  1.660e-02  2.793e-02  3.887e-02  6.027e-02
## XPerf2   -8.052e-04 -1.739e-04  1.604e-04  4.941e-04  1.133e-03
## XAge      4.167e-01  6.533e-01  7.756e-01  9.001e-01  1.125e+00
## XAge2    -2.301e-02 -1.882e-02 -1.649e-02 -1.419e-02 -9.842e-03
## XNatTeam  6.136e-01  7.718e-01  8.502e-01  9.299e-01  1.082e+00
## XGoals    4.959e-03  9.401e-03  1.174e-02  1.411e-02  1.859e-02
## XGoals2  -6.116e-05 -3.724e-05 -2.418e-05 -1.179e-05  1.182e-05
## XExp      7.644e-02  1.580e-01  1.996e-01  2.435e-01  3.234e-01
## XExp2    -1.228e-02 -8.685e-03 -6.820e-03 -4.986e-03 -1.469e-03
## XAssists -2.828e-02  3.625e-03  2.019e-02  3.677e-02  6.964e-02
## sigma2    8.316e-01  9.201e-01  9.703e-01  1.023e+00  1.134e+00</code></pre>
<p>When using our GUI (third approach), the first step is to type <strong>shiny::runGitHub(“besmarter/BSTApp” , launch.browser=T)</strong> in the R package console or any R code editor to run our GUI,<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> and then select <em>Univariate Models</em> on the top panel. The radio button on the left hand side shows the specific models inside this generic class. Users should select <em>Normal</em> model (see Figure <a href="normal-model.html#fig:Fig1">7.1</a>).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig1"></span>
<img src="images/Figure1.png" alt="Univariate models: Normal/normal-inverse gamma model." width="80%" />
<p class="caption">
Figure 7.1: Univariate models: Normal/normal-inverse gamma model.
</p>
</div>
<p>The right hand side panel displays a widget to upload the input dataset, which should be a csv file with headers in the first row. Users also should select the kind of separator used in the input file: comma, semicolon, or tab (use the folders <em>DataSim</em> and <em>DataApp</em> for the input file templates). Once users upload the dataset, they can see a data preview. Range sliders help to set the number of iterations of the MCMC and the amount of burn-in, and the thinning parameter can be selected as well. After this, users should specify the equation. This can be done with the formula builder, where users can select the dependent variable, and the independent variables, and then click on the “Build formula” tab. Users can see in the “Main Equation” space the formula expressed in the format used by R. See Main equation box in Figure <a href="normal-model.html#fig:Fig2">7.2</a>, observe that in this case the depedent variable is <span class="math inline">\(\log\text{Value}\)</span> rather than <span class="math inline">\(\text{Value}\)</span>, then we should modify directly the Main equation box writing <span class="math inline">\(log(Value)\)</span>. In general, users can modify this box if necessary, for instance, including higher order or interaction terms, other transformation are also allowed. This is done directly in the “Main Equation” space taking into account that this extra terms should follow formula command structure (see <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/formula" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/formula</a>). Note that the class of univariate models includes the intercept by default, except ordered probit, where the specification has to do this explicitly, that is, ordered probit models do not admit an intercept for identification issues (see below). Finally, users should define the hyperparameters of the prior; for instance, in the normal-inverse gamma model, these are the mean, covariance, shape, and scale (see Figure <a href="normal-model.html#fig:Fig2">7.2</a>). However, users should take into account that our GUI has “non-informative’’ hyperparameters by default in all our modelling frameworks, so the last part is not a requirement.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig2"></span>
<img src="images/Figure2.png" alt="Normal/normal-inverse gamma model: Formula builder and hyperparameters." width="80%" />
<p class="caption">
Figure 7.2: Normal/normal-inverse gamma model: Formula builder and hyperparameters.
</p>
</div>
<p>After this specification process, users should click the <em>Go!</em> button to initiate the estimation. Our GUI displays the summary statistics and convergence diagnostics after this process is finished (see Figure <a href="normal-model.html#fig:Fig3">7.3</a>). There are also widgets to download posterior chains (csv file) and graphs (pdf and eps files). Note that the order of the coefficients in the results (summary, posterior chains, and graphs) is first for the location parameters, and then for the scale parameters.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig3"></span>
<img src="images/Figure3.png" alt="Normal/normal-inverse gamma model: Results." width="80%" />
<p class="caption">
Figure 7.3: Normal/normal-inverse gamma model: Results.
</p>
</div>
<p>As expected, the results using the three approach (programming, library and GUI) are very similar. These suggest that age, squared age, national team, goals, experience, and squared experience are relevant regressors. For instance, we found that the 2.5% and 97.5% percentiles of the posterior estimate associated with the variable Goals are 4.57e-03 and 1.82e-02. These values can be used to find the 95% symmetric credible interval. This means that there is a 0.95 probability that the population parameter lies in (4.57e-03, 1.82e-02), which would suggest that this variable is relevant to explain the market value of a soccer player.<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> We also found that the effect of having been on the national team has a 95% credible interval equal to (0.58, 1.04) with a median equal to 0.81, that is, an increase of the market value of the player of 124.8% (<span class="math inline">\(\exp(0.81)-1\)</span>) compared with a player that has not ever been on a national team. The posterior distribution of this variable can be seen in Figure <a href="normal-model.html#fig:Fig10">7.4</a>. This graph is automatically generated by the GUI, and can be downloaded in the zip file named <em>Posterior Graphs.csv</em>; but we should take into account that the national team is the sixth variable, remember that by default the intercept is the first variable.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fig10"></span>
<img src="images/Fig1.png" alt="Posterior distribution: National team." width="50%" />
<p class="caption">
Figure 7.4: Posterior distribution: National team.
</p>
</div>
<p>We show all the posterior densities as well as the trace and correlation plots to visualize convergence of the posterior chains. Trace plots look stable, and autocorrelation plots decrease very quickly. In addition, convergence statistics (Geweke’s <span class="citation">(<a href="#ref-Geweke1992">J. Geweke 1992</a>)</span>, Raftery and Lewis <span class="citation">(<a href="#ref-Raftery1992">A. E. Raftery and Lewis 1992</a>)</span>, and Heidelberger and Welch’s tests <span class="citation">(<a href="#ref-Heidelberger1983">Heidelberger and Welch 1983</a>)</span>) suggest that the posterior draws come from stationary distributions (see Chapter <a href="diag.html#diag">11</a> for technical details).</p>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Geweke1992" class="csl-entry">
Geweke, J. 1992. <span>“Bayesian Statistics.”</span> In. Clarendon Press, Oxford, UK.
</div>
<div id="ref-Heidelberger1983" class="csl-entry">
Heidelberger, P., and P. D. Welch. 1983. <span>“Simulation Run Length Control in the Presence of an Initial Transient.”</span> <em>Operations Research</em> 31 (6): 1109–44.
</div>
<div id="ref-Raftery1992" class="csl-entry">
Raftery, A. E., and S. M. Lewis. 1992. <span>“One Long Run with Diagnostics: Implementation Strategies for <span>M</span>arkov Chain <span>M</span>onte <span>C</span>arlo.”</span> <em>Statistical Science</em> 7: 493–97.
</div>
<div id="ref-Serna2018" class="csl-entry">
Serna Rodríguez, M., A. Ramírez Hassan, and A. Coad. 2019. <span>“Uncovering Value Drivers of High Performance Soccer Players.”</span> <em>Journal of Sport Economics</em> 20 (6): 819–49.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>I strongly recommend to type the code line rather than copy and paste it.<a href="normal-model.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>Users should take into account that formal inference (hypothesis tests) in a Bayesian framework is based on Bayes factors.<a href="normal-model.html#fnref24" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unireg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logit-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aramir21/IntroductionBayesianEconometricsBook/06-Univariatereg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
