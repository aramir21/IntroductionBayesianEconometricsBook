<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.5 The multinomial logit model | Introduction to Bayesian Data Modeling</title>
  <meta name="description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="6.5 The multinomial logit model | Introduction to Bayesian Data Modeling" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  <meta name="github-repo" content="https://github.com/aramir21/IntroductionBayesianEconometricsBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.5 The multinomial logit model | Introduction to Bayesian Data Modeling" />
  
  <meta name="twitter:description" content="The subject of this textbook is Bayesian data modeling, with the primary aim of providing an introduction to its theoretical foundations and facilitating the application of Bayesian inference using a GUI." />
  

<meta name="author" content="Andrés Ramírez-Hassan" />


<meta name="date" content="2025-02-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec64.html"/>
<link rel="next" href="sec66.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Bayesian Econometrics: A GUIded tour using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="to-instructors-and-students.html"><a href="to-instructors-and-students.html"><i class="fa fa-check"></i>To instructors and students</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Chap1.html"><a href="Chap1.html"><i class="fa fa-check"></i><b>1</b> Basic formal concepts</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sec11.html"><a href="sec11.html"><i class="fa fa-check"></i><b>1.1</b> The Bayes’ rule</a></li>
<li class="chapter" data-level="1.2" data-path="sec12.html"><a href="sec12.html"><i class="fa fa-check"></i><b>1.2</b> Bayesian framework: A brief summary of theory</a></li>
<li class="chapter" data-level="1.3" data-path="sec14.html"><a href="sec14.html"><i class="fa fa-check"></i><b>1.3</b> Bayesian reports: Decision theory under uncertainty</a></li>
<li class="chapter" data-level="1.4" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
<li class="chapter" data-level="1.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chap2.html"><a href="Chap2.html"><i class="fa fa-check"></i><b>2</b> Conceptual differences between the Bayesian and Frequentist approaches</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec21.html"><a href="sec21.html"><i class="fa fa-check"></i><b>2.1</b> The concept of probability</a></li>
<li class="chapter" data-level="2.2" data-path="sec22.html"><a href="sec22.html"><i class="fa fa-check"></i><b>2.2</b> Subjectivity is not the key</a></li>
<li class="chapter" data-level="2.3" data-path="sec23.html"><a href="sec23.html"><i class="fa fa-check"></i><b>2.3</b> Estimation, hypothesis testing and prediction</a></li>
<li class="chapter" data-level="2.4" data-path="sec24.html"><a href="sec24.html"><i class="fa fa-check"></i><b>2.4</b> The likelihood principle</a></li>
<li class="chapter" data-level="2.5" data-path="sec25.html"><a href="sec25.html"><i class="fa fa-check"></i><b>2.5</b> Why is not the Bayesian approach that popular?</a></li>
<li class="chapter" data-level="2.6" data-path="sec26.html"><a href="sec26.html"><i class="fa fa-check"></i><b>2.6</b> A simple working example</a></li>
<li class="chapter" data-level="2.7" data-path="sec27.html"><a href="sec27.html"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
<li class="chapter" data-level="2.8" data-path="sec28.html"><a href="sec28.html"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chap3.html"><a href="Chap3.html"><i class="fa fa-check"></i><b>3</b> Cornerstone models: Conjugate families</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec41.html"><a href="sec41.html"><i class="fa fa-check"></i><b>3.1</b> Motivation of conjugate families</a></li>
<li class="chapter" data-level="3.2" data-path="sec42.html"><a href="sec42.html"><i class="fa fa-check"></i><b>3.2</b> Conjugate prior to exponential family</a></li>
<li class="chapter" data-level="3.3" data-path="sec43.html"><a href="sec43.html"><i class="fa fa-check"></i><b>3.3</b> Linear regression: The conjugate normal-normal/inverse gamma model</a></li>
<li class="chapter" data-level="3.4" data-path="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><a href="multivariate-linear-regression-the-conjugate-normal-normalinverse-wishart-model.html"><i class="fa fa-check"></i><b>3.4</b> Multivariate linear regression: The conjugate normal-normal/inverse Wishart model</a></li>
<li class="chapter" data-level="3.5" data-path="computational-examples.html"><a href="computational-examples.html"><i class="fa fa-check"></i><b>3.5</b> Computational examples</a></li>
<li class="chapter" data-level="3.6" data-path="summary-chapter-4.html"><a href="summary-chapter-4.html"><i class="fa fa-check"></i><b>3.6</b> Summary: Chapter 4</a></li>
<li class="chapter" data-level="3.7" data-path="exercises-chapter-4.html"><a href="exercises-chapter-4.html"><i class="fa fa-check"></i><b>3.7</b> Exercises: Chapter 4</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chap4.html"><a href="Chap4.html"><i class="fa fa-check"></i><b>4</b> Simulation methods</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec51.html"><a href="sec51.html"><i class="fa fa-check"></i><b>4.1</b> Markov Chain Monte Carlo methods</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sec51.html"><a href="sec51.html#sec511"><i class="fa fa-check"></i><b>4.1.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="4.1.2" data-path="sec51.html"><a href="sec51.html#sec512"><i class="fa fa-check"></i><b>4.1.2</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="4.1.3" data-path="sec51.html"><a href="sec51.html#sec513"><i class="fa fa-check"></i><b>4.1.3</b> Hamiltonian Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec52.html"><a href="sec52.html"><i class="fa fa-check"></i><b>4.2</b> Importance sampling</a></li>
<li class="chapter" data-level="4.3" data-path="sec53.html"><a href="sec53.html"><i class="fa fa-check"></i><b>4.3</b> Particle filtering</a></li>
<li class="chapter" data-level="4.4" data-path="sec54.html"><a href="sec54.html"><i class="fa fa-check"></i><b>4.4</b> Convergence diagnostics</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sec54.html"><a href="sec54.html#numerical-standard-error"><i class="fa fa-check"></i><b>4.4.1</b> Numerical standard error</a></li>
<li class="chapter" data-level="4.4.2" data-path="sec54.html"><a href="sec54.html#effective-number-of-simulation-draws"><i class="fa fa-check"></i><b>4.4.2</b> Effective number of simulation draws</a></li>
<li class="chapter" data-level="4.4.3" data-path="sec54.html"><a href="sec54.html#tests-of-convergence"><i class="fa fa-check"></i><b>4.4.3</b> Tests of convergence</a></li>
<li class="chapter" data-level="4.4.4" data-path="sec54.html"><a href="sec54.html#checking-for-errors-in-the-posterior-simulator"><i class="fa fa-check"></i><b>4.4.4</b> Checking for errors in the posterior simulator</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sec55.html"><a href="sec55.html"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
<li class="chapter" data-level="4.6" data-path="sec56.html"><a href="sec56.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chap5.html"><a href="Chap5.html"><i class="fa fa-check"></i><b>5</b> Graphical user interface</a></li>
<li class="chapter" data-level="6" data-path="Chap6.html"><a href="Chap6.html"><i class="fa fa-check"></i><b>6</b> Univariate regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec61.html"><a href="sec61.html"><i class="fa fa-check"></i><b>6.1</b> The Gaussian linear model</a></li>
<li class="chapter" data-level="6.2" data-path="sec62.html"><a href="sec62.html"><i class="fa fa-check"></i><b>6.2</b> The logit model</a></li>
<li class="chapter" data-level="6.3" data-path="sec63.html"><a href="sec63.html"><i class="fa fa-check"></i><b>6.3</b> The probit model</a></li>
<li class="chapter" data-level="6.4" data-path="sec64.html"><a href="sec64.html"><i class="fa fa-check"></i><b>6.4</b> The multinomial probit model</a></li>
<li class="chapter" data-level="6.5" data-path="sec65.html"><a href="sec65.html"><i class="fa fa-check"></i><b>6.5</b> The multinomial logit model</a></li>
<li class="chapter" data-level="6.6" data-path="sec66.html"><a href="sec66.html"><i class="fa fa-check"></i><b>6.6</b> Ordered probit model</a></li>
<li class="chapter" data-level="6.7" data-path="negative-binomial-model.html"><a href="negative-binomial-model.html"><i class="fa fa-check"></i><b>6.7</b> Negative binomial model</a></li>
<li class="chapter" data-level="6.8" data-path="sec68.html"><a href="sec68.html"><i class="fa fa-check"></i><b>6.8</b> Tobit model</a></li>
<li class="chapter" data-level="6.9" data-path="sec69.html"><a href="sec69.html"><i class="fa fa-check"></i><b>6.9</b> Quantile regression</a></li>
<li class="chapter" data-level="6.10" data-path="sec610.html"><a href="sec610.html"><i class="fa fa-check"></i><b>6.10</b> Bayesian bootstrap regression</a></li>
<li class="chapter" data-level="6.11" data-path="sec611.html"><a href="sec611.html"><i class="fa fa-check"></i><b>6.11</b> Summary</a></li>
<li class="chapter" data-level="6.12" data-path="sec612.html"><a href="sec612.html"><i class="fa fa-check"></i><b>6.12</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Chap8.html"><a href="Chap8.html"><i class="fa fa-check"></i><b>7</b> Time series</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Bayesian Data Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec65" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> The multinomial logit model<a href="sec65.html#sec65" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The multinomial logit model is used to model mutually exclusive discrete outcomes or qualitative response variables. However, this model assumes the independence of irrelevant alternatives (IIA), meaning that the choice between two alternatives does not depend on a third alternative. We consider the multinomial mixed logit model (not to be confused with the random parameters logit model), which accounts for both alternative-varying regressors (conditional) and alternative-invariant regressors (multinomial) simultaneously.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>In this setting, there are <span class="math inline">\(L\)</span> mutually exclusive alternatives, and the dependent variable <span class="math inline">\(y_{il}\)</span> is equal to 1 if the <span class="math inline">\(l\)</span>th alternative is chosen by individual <span class="math inline">\(i\)</span>, and 0 otherwise, where <span class="math inline">\(l=\left\{1,2,\dots,L\right\}\)</span>. The likelihood function is</p>
<p><span class="math display">\[
p(\boldsymbol{\beta} \mid \boldsymbol{y}, \boldsymbol{X}) = \prod_{i=1}^{N} \prod_{l=1}^{L} p_{il}^{y_{il}},
\]</span></p>
<p>where the probability that individual <span class="math inline">\(i\)</span> chooses the alternative <span class="math inline">\(l\)</span> is given by</p>
<p><span class="math display">\[
p_{il} := p(y_i = l \mid \boldsymbol{\beta}, \boldsymbol{X}) = \frac{\exp\left\{\boldsymbol{x}_{il}^{\top} \boldsymbol{\beta}_l\right\}}{\sum_{j=1}^{L} \exp\left\{\boldsymbol{x}_{ij}^{\top} \boldsymbol{\beta}_j\right\}},
\]</span></p>
<p><span class="math inline">\(\boldsymbol{y}\)</span> and <span class="math inline">\(\boldsymbol{X}\)</span> are the vector and matrix of the dependent variable and regressors, respectively, and <span class="math inline">\(\boldsymbol{\beta}\)</span> is the vector containing all the coefficients.</p>
<p>Remember that coefficients associated with alternative-invariant regressors are set to 0 for the baseline category, and the coefficients associated with the alternative-varying regressors are the same for all the categories. In addition, we assume <span class="math inline">\(\boldsymbol{\beta} \sim N(\boldsymbol{\beta}_0, \boldsymbol{B}_0)\)</span> as the prior distribution. Thus, the posterior distribution is</p>
<p><span class="math display">\[
\pi(\boldsymbol{\beta} \mid \boldsymbol{y}, \boldsymbol{X}) \propto p(\boldsymbol{\beta} \mid \boldsymbol{y}, \boldsymbol{X}) \times \pi(\boldsymbol{\beta}).
\]</span></p>
<p>As the multinomial logit model does not have a standard posterior distribution, <span class="citation">P. E. Rossi, Allenby, and McCulloch (<a href="#ref-rossi2012bayesian">2012</a>)</span> propose a “tailored” independent Metropolis-Hastings algorithm where the proposal distribution is a multivariate Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(v\)</span> degrees of freedom (tuning parameter), mean equal to the maximum likelihood estimator, and scale equal to the inverse of the Hessian matrix.</p>
<p><strong>Example: Simulation exercise</strong></p>
<p>Let’s conduct a simulation exercise to evaluate the performance of the Metropolis-Hastings algorithm for inference in the multinomial logit model. We consider a scenario with three alternatives, one alternative-invariant regressor (plus the intercept), and three alternative-varying regressors. The population parameters are given by <span class="math inline">\(\boldsymbol{\beta}_1 = [1 \ -2.5 \ 0.5 \ 0.8 \ -3]^{\top}\)</span>, <span class="math inline">\(\boldsymbol{\beta}_2 = [1 \ -3.5 \ 0.5 \ 0.8 \ -3]^{\top}\)</span>, and <span class="math inline">\(\boldsymbol{\beta}_3 = [0 \ 0 \ 0.5 \ 0.8 \ -3]^{\top}\)</span>, where the first two elements of each vector correspond to the intercept and the alternative-invariant regressor, while the last three elements correspond to the alternative-varying regressors. The sample size is 1000, and all regressors are simulated from standard normal distributions.</p>
<p>We can deploy our GUI using the command line at the beginning of this chapter. We should follow the next Algorithm to run multinomial logit models in our GUI (see Chapter <a href="Chap5.html#Chap5">5</a> for details).</p>
<div class="algorithm">
<div style="background-color: #f8f9fa; padding: 15px; border-left: 5px solid #343a40; box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.1); border-radius: 5px;">
<p><strong>Algorithm: Multinomial logit models</strong></p>
<ol style="list-style-type: decimal">
<li>Select <em>Univariate Models</em> on the top panel<br />
</li>
<li>Select <em>Multinomial Logit</em> model using the left radio button<br />
</li>
<li>Upload the dataset by first selecting whether there is a header in the file, and the kind of separator in the <em>csv</em> file of the dataset (comma, semicolon, or tab). Then, use the <em>Browse</em> button under the <strong>Choose File</strong> legend. You should see a preview of the dataset<br />
</li>
<li>Select MCMC iterations, burn-in, and thinning parameters using the <em>Range sliders</em><br />
</li>
<li>Select dependent and independent variables using the <em>Formula builder</em> table<br />
</li>
<li>Select the <strong>Base Alternative</strong><br />
</li>
<li>Select the <strong>Number of choice categorical alternatives</strong><br />
</li>
<li>Select the <strong>Number of alternative specific variables</strong><br />
</li>
<li>Select the <strong>Number of Non-alternative specific variables</strong><br />
</li>
<li>Click the <em>Build formula</em> button to generate the formula in <strong>R</strong> syntax.<br />
</li>
<li>Set the hyperparameters: mean vector and covariance matrix. This step is not necessary as by default our GUI uses non-informative priors<br />
</li>
<li>Select the tuning parameter for the Metropolis-Hastings algorithm, that is, the <strong>Degrees of freedom: Multivariate Student’s t distribution</strong><br />
</li>
<li>Click the <em>Go!</em> button<br />
</li>
<li>Analyze results<br />
</li>
<li>Download posterior chains and diagnostic plots using the <em>Download Posterior Chains</em> and <em>Download Posterior Graphs</em> buttons</li>
</ol>
</div>
</div>
<p>The following code in <strong>R</strong> demonstrates how to implement the M-H algorithm from scratch. The first part simulates the dataset, the second part constructs the log-likelihood function, and the third part implements the M-H algorithm. We use vague priors centered at zero, with a covariance matrix of <span class="math inline">\(1000\mathbf{I}_7\)</span>. We observe that the posterior estimates closely match the population parameters, and all 95% credible intervals contain the population parameters.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sec65.html#cb33-1" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb33-2"><a href="sec65.html#cb33-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb33-3"><a href="sec65.html#cb33-3" tabindex="-1"></a><span class="co"># Simulation of data</span></span>
<span id="cb33-4"><a href="sec65.html#cb33-4" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span>  <span class="co"># Sample Size</span></span>
<span id="cb33-5"><a href="sec65.html#cb33-5" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="sc">-</span><span class="dv">3</span>); B1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="dv">0</span>); B2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb33-6"><a href="sec65.html#cb33-6" tabindex="-1"></a><span class="co"># Alternative specific attributes of choice 1, for instance, price, quality and duration of choice 1</span></span>
<span id="cb33-7"><a href="sec65.html#cb33-7" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">cbind</span>(<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)),N,<span class="fu">length</span>(B)) </span>
<span id="cb33-8"><a href="sec65.html#cb33-8" tabindex="-1"></a><span class="co"># Alternative specific attributes of choice 2, for instance, price, quality and duration of choice 2</span></span>
<span id="cb33-9"><a href="sec65.html#cb33-9" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">cbind</span>(<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)),N,<span class="fu">length</span>(B))</span>
<span id="cb33-10"><a href="sec65.html#cb33-10" tabindex="-1"></a><span class="co"># Alternative specific attributes of choice 3, for instance, price, quality and duration of choice 3</span></span>
<span id="cb33-11"><a href="sec65.html#cb33-11" tabindex="-1"></a>X3<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">cbind</span>(<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)),N,<span class="fu">length</span>(B))</span>
<span id="cb33-12"><a href="sec65.html#cb33-12" tabindex="-1"></a>X4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(N,<span class="dv">1</span>,<span class="dv">1</span>),N,<span class="dv">1</span>)</span>
<span id="cb33-13"><a href="sec65.html#cb33-13" tabindex="-1"></a>V1<span class="ot">&lt;-</span>B2[<span class="dv">1</span>]<span class="sc">+</span>X1<span class="sc">%*%</span>B<span class="sc">+</span>B1[<span class="dv">1</span>]<span class="sc">*</span>X4; V2<span class="ot">&lt;-</span>B2[<span class="dv">2</span>]<span class="sc">+</span>X2<span class="sc">%*%</span>B<span class="sc">+</span>B1[<span class="dv">2</span>]<span class="sc">*</span>X4; V3<span class="ot">&lt;-</span>B2[<span class="dv">3</span>]<span class="sc">+</span>X3<span class="sc">%*%</span>B<span class="sc">+</span>B1[<span class="dv">3</span>]<span class="sc">*</span>X4</span>
<span id="cb33-14"><a href="sec65.html#cb33-14" tabindex="-1"></a>suma<span class="ot">&lt;-</span><span class="fu">exp</span>(V1)<span class="sc">+</span><span class="fu">exp</span>(V2)<span class="sc">+</span><span class="fu">exp</span>(V3)</span>
<span id="cb33-15"><a href="sec65.html#cb33-15" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">exp</span>(V1)<span class="sc">/</span>suma; p2<span class="ot">&lt;-</span><span class="fu">exp</span>(V2)<span class="sc">/</span>suma; p3<span class="ot">&lt;-</span><span class="fu">exp</span>(V3)<span class="sc">/</span>suma</span>
<span id="cb33-16"><a href="sec65.html#cb33-16" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">cbind</span>(p1,p2,p3)</span>
<span id="cb33-17"><a href="sec65.html#cb33-17" tabindex="-1"></a>y<span class="ot">&lt;-</span> <span class="fu">apply</span>(p,<span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="at">prob =</span> x, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb33-18"><a href="sec65.html#cb33-18" tabindex="-1"></a>y1<span class="ot">&lt;-</span>y<span class="sc">==</span><span class="dv">1</span>; y2<span class="ot">&lt;-</span>y<span class="sc">==</span><span class="dv">2</span>; y3<span class="ot">&lt;-</span>y<span class="sc">==</span><span class="dv">3</span></span>
<span id="cb33-19"><a href="sec65.html#cb33-19" tabindex="-1"></a><span class="co"># Log likelihood</span></span>
<span id="cb33-20"><a href="sec65.html#cb33-20" tabindex="-1"></a>log.L<span class="ot">&lt;-</span> <span class="cf">function</span>(Beta){</span>
<span id="cb33-21"><a href="sec65.html#cb33-21" tabindex="-1"></a>    V1<span class="ot">&lt;-</span>Beta[<span class="dv">1</span>]<span class="sc">+</span>Beta[<span class="dv">3</span>]<span class="sc">*</span>X4<span class="sc">+</span>X1<span class="sc">%*%</span>Beta[<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb33-22"><a href="sec65.html#cb33-22" tabindex="-1"></a>    V2<span class="ot">&lt;-</span>Beta[<span class="dv">2</span>]<span class="sc">+</span>Beta[<span class="dv">4</span>]<span class="sc">*</span>X4<span class="sc">+</span>X2<span class="sc">%*%</span>Beta[<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb33-23"><a href="sec65.html#cb33-23" tabindex="-1"></a>    V3<span class="ot">&lt;-</span> X3<span class="sc">%*%</span>Beta[<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb33-24"><a href="sec65.html#cb33-24" tabindex="-1"></a>    suma<span class="ot">&lt;-</span><span class="fu">exp</span>(V1)<span class="sc">+</span><span class="fu">exp</span>(V2)<span class="sc">+</span><span class="fu">exp</span>(V3)</span>
<span id="cb33-25"><a href="sec65.html#cb33-25" tabindex="-1"></a>    p11<span class="ot">&lt;-</span><span class="fu">exp</span>(V1)<span class="sc">/</span>suma;  p22<span class="ot">&lt;-</span><span class="fu">exp</span>(V2)<span class="sc">/</span>suma;  p33<span class="ot">&lt;-</span><span class="fu">exp</span>(V3)<span class="sc">/</span>suma</span>
<span id="cb33-26"><a href="sec65.html#cb33-26" tabindex="-1"></a>    suma2<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb33-27"><a href="sec65.html#cb33-27" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb33-28"><a href="sec65.html#cb33-28" tabindex="-1"></a>        suma1<span class="ot">&lt;-</span>y1[i]<span class="sc">*</span><span class="fu">log</span>(p11[i])<span class="sc">+</span>y2[i]<span class="sc">*</span><span class="fu">log</span>(p22[i])<span class="sc">+</span>y3[i]<span class="sc">*</span><span class="fu">log</span>(p33[i])</span>
<span id="cb33-29"><a href="sec65.html#cb33-29" tabindex="-1"></a>        suma2<span class="ot">&lt;-</span><span class="fu">c</span>(suma2,suma1)}</span>
<span id="cb33-30"><a href="sec65.html#cb33-30" tabindex="-1"></a>    logL<span class="ot">&lt;-</span><span class="fu">sum</span>(suma2)</span>
<span id="cb33-31"><a href="sec65.html#cb33-31" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span>logL)</span>
<span id="cb33-32"><a href="sec65.html#cb33-32" tabindex="-1"></a>}</span>
<span id="cb33-33"><a href="sec65.html#cb33-33" tabindex="-1"></a><span class="co"># Parameters: Proposal</span></span>
<span id="cb33-34"><a href="sec65.html#cb33-34" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb33-35"><a href="sec65.html#cb33-35" tabindex="-1"></a>res.optim<span class="ot">&lt;-</span><span class="fu">optim</span>(<span class="fu">rep</span>(<span class="dv">0</span>, k), log.L, <span class="at">method=</span><span class="st">&quot;BFGS&quot;</span>, <span class="at">hessian=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-36"><a href="sec65.html#cb33-36" tabindex="-1"></a>MeanT <span class="ot">&lt;-</span> res.optim<span class="sc">$</span>par</span>
<span id="cb33-37"><a href="sec65.html#cb33-37" tabindex="-1"></a>ScaleT <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Matrix<span class="sc">::</span><span class="fu">forceSymmetric</span>(<span class="fu">solve</span>(res.optim<span class="sc">$</span>hessian))) <span class="co"># Force this matrix to be symmetric</span></span>
<span id="cb33-38"><a href="sec65.html#cb33-38" tabindex="-1"></a><span class="co"># Hyperparameters: Priors</span></span>
<span id="cb33-39"><a href="sec65.html#cb33-39" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">diag</span>(k); b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb33-40"><a href="sec65.html#cb33-40" tabindex="-1"></a>MHfunction <span class="ot">&lt;-</span> <span class="cf">function</span>(iter, tuning){</span>
<span id="cb33-41"><a href="sec65.html#cb33-41" tabindex="-1"></a>    Beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k); Acept <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb33-42"><a href="sec65.html#cb33-42" tabindex="-1"></a>    BetasPost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, iter, k)</span>
<span id="cb33-43"><a href="sec65.html#cb33-43" tabindex="-1"></a>    pb <span class="ot">&lt;-</span> <span class="fu">winProgressBar</span>(<span class="at">title =</span> <span class="st">&quot;progress bar&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> iter, <span class="at">width =</span> <span class="dv">300</span>)</span>
<span id="cb33-44"><a href="sec65.html#cb33-44" tabindex="-1"></a>    <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb33-45"><a href="sec65.html#cb33-45" tabindex="-1"></a>        LogPostBeta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log.L</span>(Beta) <span class="sc">+</span> mvtnorm<span class="sc">::</span><span class="fu">dmvnorm</span>(Beta, <span class="at">mean =</span> b0, <span class="at">sigma =</span> B0, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-46"><a href="sec65.html#cb33-46" tabindex="-1"></a>        BetaC <span class="ot">&lt;-</span> <span class="fu">c</span>(LaplacesDemon<span class="sc">::</span><span class="fu">rmvt</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mu =</span> MeanT, <span class="at">S =</span> ScaleT, <span class="at">df =</span> tuning))</span>
<span id="cb33-47"><a href="sec65.html#cb33-47" tabindex="-1"></a>        LogPostBetaC <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log.L</span>(BetaC) <span class="sc">+</span> mvtnorm<span class="sc">::</span><span class="fu">dmvnorm</span>(BetaC, <span class="at">mean =</span> b0, <span class="at">sigma =</span> B0, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-48"><a href="sec65.html#cb33-48" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">exp</span>((LogPostBetaC<span class="sc">-</span>mvtnorm<span class="sc">::</span><span class="fu">dmvt</span>(BetaC, <span class="at">delta =</span> MeanT, <span class="at">sigma =</span> ScaleT, <span class="at">df =</span> tuning, <span class="at">log =</span> <span class="cn">TRUE</span>))<span class="sc">-</span>(LogPostBeta<span class="sc">-</span>mvtnorm<span class="sc">::</span><span class="fu">dmvt</span>(Beta, <span class="at">delta =</span> MeanT, <span class="at">sigma =</span> ScaleT, <span class="at">df =</span> tuning, <span class="at">log =</span> <span class="cn">TRUE</span>))) ,<span class="dv">1</span>)</span>
<span id="cb33-49"><a href="sec65.html#cb33-49" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb33-50"><a href="sec65.html#cb33-50" tabindex="-1"></a>        <span class="cf">if</span>(u <span class="sc">&lt;=</span> alpha){</span>
<span id="cb33-51"><a href="sec65.html#cb33-51" tabindex="-1"></a>            Acepti <span class="ot">&lt;-</span> <span class="dv">1</span>; Beta <span class="ot">&lt;-</span> BetaC</span>
<span id="cb33-52"><a href="sec65.html#cb33-52" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb33-53"><a href="sec65.html#cb33-53" tabindex="-1"></a>            Acepti <span class="ot">&lt;-</span> <span class="dv">0</span>; Beta <span class="ot">&lt;-</span> Beta</span>
<span id="cb33-54"><a href="sec65.html#cb33-54" tabindex="-1"></a>        }</span>
<span id="cb33-55"><a href="sec65.html#cb33-55" tabindex="-1"></a>        BetasPost[s, ] <span class="ot">&lt;-</span> Beta; Acept <span class="ot">&lt;-</span> <span class="fu">c</span>(Acept, Acepti)</span>
<span id="cb33-56"><a href="sec65.html#cb33-56" tabindex="-1"></a>        <span class="fu">setWinProgressBar</span>(pb, s, <span class="at">title=</span><span class="fu">paste</span>( <span class="fu">round</span>(s<span class="sc">/</span>iter<span class="sc">*</span><span class="dv">100</span>, <span class="dv">0</span>),<span class="st">&quot;% done&quot;</span>))</span>
<span id="cb33-57"><a href="sec65.html#cb33-57" tabindex="-1"></a>    }</span>
<span id="cb33-58"><a href="sec65.html#cb33-58" tabindex="-1"></a>    <span class="fu">close</span>(pb); AcepRate <span class="ot">&lt;-</span> <span class="fu">mean</span>(Acept)</span>
<span id="cb33-59"><a href="sec65.html#cb33-59" tabindex="-1"></a>    Results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">AcepRate =</span> AcepRate, <span class="at">BetasPost =</span> BetasPost)</span>
<span id="cb33-60"><a href="sec65.html#cb33-60" tabindex="-1"></a>    <span class="fu">return</span>(Results)</span>
<span id="cb33-61"><a href="sec65.html#cb33-61" tabindex="-1"></a>}</span>
<span id="cb33-62"><a href="sec65.html#cb33-62" tabindex="-1"></a><span class="co"># MCMC parameters</span></span>
<span id="cb33-63"><a href="sec65.html#cb33-63" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> <span class="dv">10000</span>; burnin <span class="ot">&lt;-</span> <span class="dv">1000</span>; thin <span class="ot">&lt;-</span> <span class="dv">5</span>; iter <span class="ot">&lt;-</span> mcmc <span class="sc">+</span> burnin; keep <span class="ot">&lt;-</span> <span class="fu">seq</span>(burnin, iter, thin); tuning <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># Degrees of freedom</span></span>
<span id="cb33-64"><a href="sec65.html#cb33-64" tabindex="-1"></a>ResultsPost <span class="ot">&lt;-</span> <span class="fu">MHfunction</span>(<span class="at">iter =</span> iter, <span class="at">tuning =</span> tuning)</span>
<span id="cb33-65"><a href="sec65.html#cb33-65" tabindex="-1"></a><span class="fu">summary</span>(coda<span class="sc">::</span><span class="fu">mcmc</span>(ResultsPost<span class="sc">$</span>BetasPost[keep[<span class="sc">-</span><span class="dv">1</span>], ]))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:2000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 2000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##         Mean      SD Naive SE Time-series SE
## [1,]  0.9711 0.20162 0.004508       0.004508
## [2,]  0.9742 0.20934 0.004681       0.004681
## [3,] -2.4350 0.18950 0.004237       0.004137
## [4,] -3.4195 0.24656 0.005513       0.005513
## [5,]  0.5253 0.07396 0.001654       0.001654
## [6,]  0.8061 0.08007 0.001790       0.001790
## [7,] -3.0853 0.17689 0.003955       0.003955
## 
## 2. Quantiles for each variable:
## 
##         2.5%     25%     50%     75%   97.5%
## var1  0.5862  0.8367  0.9650  1.1017  1.3683
## var2  0.5679  0.8310  0.9681  1.1151  1.3761
## var3 -2.8239 -2.5607 -2.4291 -2.3050 -2.0812
## var4 -3.9176 -3.5806 -3.4074 -3.2496 -2.9423
## var5  0.3840  0.4761  0.5250  0.5759  0.6647
## var6  0.6555  0.7494  0.8064  0.8616  0.9604
## var7 -3.4476 -3.1991 -3.0777 -2.9641 -2.7500</code></pre>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-rossi2012bayesian" class="csl-entry">
Rossi, Peter E, Greg M Allenby, and Rob McCulloch. 2012. <em>Bayesian Statistics and Marketing</em>. John Wiley &amp; Sons.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>The multinomial mixed logit model can be implemented as a conditional logit model.<a href="sec65.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec64.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec66.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aramir21/IntroductionBayesianEconometricsBook/06-Univariatereg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
